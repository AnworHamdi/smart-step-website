import{u as C,i as R,r,D as k,j as e,c as T,d as E}from"./index-CTFYKnJ2.js";import{C as f}from"./Card-CxKyUKUl.js";import{B as w}from"./Button-DuFCzZAU.js";import{u as L}from"./useSeo-CUnsv19d.js";const F=()=>{const{t:s}=C();L(s("resetPasswordPage.title"),s("resetPasswordPage.otpSubtitle"));const d=R(),{updateUserPassword:h}=r.useContext(k),[m,P]=r.useState(""),[l,b]=r.useState(""),[u,j]=r.useState(""),[x,a]=r.useState(""),[i,p]=r.useState(!1),[y,v]=r.useState(!1),[g,N]=r.useState(600);r.useEffect(()=>{const t=sessionStorage.getItem("passwordReset");if(!t){d("/forgot-password");return}const n=JSON.parse(t);new Date().getTime()>n.expiry&&(a(s("resetPasswordPage.otpExpired")),sessionStorage.removeItem("passwordReset"));const o=setInterval(()=>{N(c=>c>0?c-1:0)},1e3);return()=>clearInterval(o)},[d,s]);const S=t=>{t.preventDefault(),a("");const n=sessionStorage.getItem("passwordReset");if(!n){a(s("resetPasswordPage.otpExpired"));return}const o=JSON.parse(n);if(new Date().getTime()>o.expiry){a(s("resetPasswordPage.otpExpired")),sessionStorage.removeItem("passwordReset");return}if(m!==o.otp){a(s("resetPasswordPage.invalidOtp"));return}if(l.length<8){a(s("resetPasswordPage.validation.passwordLength"));return}if(l!==u){a(s("resetPasswordPage.validation.passwordMismatch"));return}p(!0),setTimeout(()=>{h(o.email,l)?(v(!0),sessionStorage.removeItem("passwordReset")):a("An unexpected error occurred."),p(!1)},1e3)},I=t=>{const n=Math.floor(t/60),o=t%60;return`${n}:${o<10?"0":""}${o}`};return y?e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)] bg-gray-50 py-12 px-4",children:e.jsxs(f,{className:"p-10 max-w-md w-full text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"bg-smart-green rounded-full h-16 w-16 flex items-center justify-center",children:e.jsx(T,{className:"h-8 w-8 text-white"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:s("resetPasswordPage.successTitle")}),e.jsx("p",{className:"mt-2 text-gray-600",children:s("resetPasswordPage.successMessage")}),e.jsx("div",{className:"mt-6",children:e.jsx(w,{to:"/login",children:s("resetPasswordPage.backToLogin")})})]})}):e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)] bg-gray-50 py-12 px-4",children:e.jsx("div",{className:"max-w-md w-full space-y-8",children:e.jsxs(f,{className:"p-10 animate-on-scroll is-visible",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-smart-blue",children:s("resetPasswordPage.title")}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:s("resetPasswordPage.otpSubtitle")}),e.jsx("p",{className:"font-mono text-lg font-bold text-red-500 mt-2",children:I(g)})]}),e.jsxs("form",{className:"mt-8 space-y-4",onSubmit:S,noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700",children:s("resetPasswordPage.otpLabel")}),e.jsx("input",{id:"otp",name:"otp",type:"text",maxLength:6,value:m,onChange:t=>P(t.target.value),required:!0,className:"mt-1 appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-smart-blue focus:border-smart-blue sm:text-sm",placeholder:s("resetPasswordPage.otpPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700",children:s("resetPasswordPage.newPasswordLabel")}),e.jsx("input",{id:"newPassword",name:"newPassword",type:"password",value:l,onChange:t=>b(t.target.value),required:!0,className:"mt-1 appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-smart-blue focus:border-smart-blue sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:s("resetPasswordPage.confirmPasswordLabel")}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:u,onChange:t=>j(t.target.value),required:!0,className:"mt-1 appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-smart-blue focus:border-smart-blue sm:text-sm"})]}),x&&e.jsx("p",{className:"text-sm text-red-600 text-center",role:"alert",children:x}),e.jsx("div",{className:"pt-2",children:e.jsx(w,{type:"submit",className:"w-full flex justify-center",disabled:i||g===0,children:i?e.jsx(E,{className:"h-5 w-5 text-white"}):s(i?"resetPasswordPage.resetting":"resetPasswordPage.resetButton")})})]})]})})})};export{F as default};

import{h as oe,u as Y,j as e,r as a,l as be,m as Ce,n as ae,o as Me,p as Le,D as ne,d as ee,q as ie,c as Re,e as Te,t as Ie,v as ve,w as Ue,x as ze,y as Ae,z as Pe,E as Be,F as He}from"./index-CTFYKnJ2.js";import{B as $}from"./Button-DuFCzZAU.js";import{C as te}from"./Card-CxKyUKUl.js";const ke=({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),$e=({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Ve=({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),We=({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),Ke=({className:s="w-5 h-5"})=>e.jsxs("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),_e=({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),we=({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Oe=({className:s="w-5 h-5"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),qe=({className:s="w-6 h-6"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),Ge=({className:s="w-6 h-6"})=>e.jsx("svg",{className:s,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Xe=({activeSection:s,onSectionChange:j,isOpen:i,onToggle:v})=>{var f;const{user:b,logout:r}=oe(),{t:x}=Y(),m=[{id:"posts",label:x("dashboard.tabs.posts"),icon:ke},{id:"media",label:x("dashboard.tabs.media"),icon:we},{id:"messages",label:x("dashboard.tabs.messages"),icon:$e},{id:"subscriptions",label:x("dashboard.tabs.subscriptions")||"Subscriptions",icon:_e},{id:"users",label:x("dashboard.tabs.users"),icon:Ve},{id:"team",label:x("dashboard.tabs.team"),icon:We},{id:"settings",label:x("dashboard.tabs.settings"),icon:Ke}],h=[{id:"posts",label:x("dashboard.tabs.posts"),icon:ke},{id:"media",label:x("dashboard.tabs.media"),icon:we}],k=(b==null?void 0:b.role)==="admin"||(b==null?void 0:b.role)==="Super admin"?m:h,c=p=>{j(p),window.innerWidth<1024&&v()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:v,className:"lg:hidden fixed top-20 left-4 z-50 bg-smart-blue text-white p-2 rounded-lg shadow-lg","aria-label":"Toggle menu",children:i?e.jsx(Ge,{}):e.jsx(qe,{})}),i&&e.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30",onClick:v}),e.jsxs("aside",{className:`
          fixed lg:sticky top-0 left-0 h-screen bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700
          w-64 z-40 transform transition-transform duration-300 ease-in-out flex flex-col
          ${i?"translate-x-0":"-translate-x-full lg:translate-x-0"}
        `,children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-smart-blue text-white flex items-center justify-center font-bold text-lg",children:(f=b==null?void 0:b.email)==null?void 0:f.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:b==null?void 0:b.email}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:b==null?void 0:b.role})]})]})}),e.jsx("nav",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("ul",{className:"space-y-2",children:k.map(p=>{const y=p.icon,E=s===p.id;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>c(p.id),className:`
                      w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200
                      ${E?"bg-smart-blue text-white shadow-md":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}
                    `,children:[e.jsx(y,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:p.label})]})},p.id)})})}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("button",{onClick:r,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-all duration-200",children:[e.jsx(Oe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:x("nav.logout")})]})})]})]})},Ne=({value:s,onChange:j,placeholder:i="Enter content...",className:v="",dir:b="ltr"})=>{const r=a.useRef(null),x=a.useRef(!1);a.useEffect(()=>{r.current&&!x.current&&r.current.innerHTML!==s&&(r.current.innerHTML=s||""),x.current=!1},[s]);const m=a.useCallback(()=>{if(r.current){x.current=!0;const f=r.current.innerHTML,p=f==="<br>"||f==="<div><br></div>"||f.trim()==="";j(p?"":f)}},[j]),h=a.useCallback((f,p)=>{var y;document.execCommand(f,!1,p),(y=r.current)==null||y.focus(),m()},[m]),k=a.useCallback(f=>{f.key==="Tab"&&(f.preventDefault(),h("insertHTML","&nbsp;&nbsp;&nbsp;&nbsp;"))},[h]),c=({onClick:f,title:p,children:y,active:E})=>e.jsx("button",{type:"button",onClick:f,title:p,className:`p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors ${E?"bg-gray-200 dark:bg-gray-600":""}`,children:y});return e.jsxs("div",{className:`rich-text-editor border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden ${v}`,children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 bg-gray-50 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600",children:[e.jsx(c,{onClick:()=>h("bold"),title:"Bold",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"})})}),e.jsx(c,{onClick:()=>h("italic"),title:"Italic",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"})})}),e.jsx(c,{onClick:()=>h("underline"),title:"Underline",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"})})}),e.jsx(c,{onClick:()=>h("strikeThrough"),title:"Strikethrough",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M10 19h4v-3h-4v3zM5 4v3h5v3h4V7h5V4H5zM3 14h18v-2H3v2z"})})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),e.jsxs("select",{onChange:f=>h("formatBlock",f.target.value),className:"px-2 py-1 text-sm bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded",defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Heading"}),e.jsx("option",{value:"p",children:"Normal"}),e.jsx("option",{value:"h1",children:"Heading 1"}),e.jsx("option",{value:"h2",children:"Heading 2"}),e.jsx("option",{value:"h3",children:"Heading 3"})]}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),e.jsx(c,{onClick:()=>h("insertUnorderedList"),title:"Bullet List",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"})})}),e.jsx(c,{onClick:()=>h("insertOrderedList"),title:"Numbered List",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"})})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),e.jsx(c,{onClick:()=>{const f=prompt("Enter URL:");f&&h("createLink",f)},title:"Insert Link",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"})})}),e.jsx(c,{onClick:()=>h("removeFormat"),title:"Clear Formatting",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M3.27 5L2 6.27l6.97 6.97L6.5 19h3l1.57-3.66L16.73 21 18 19.73 3.55 5.27 3.27 5zM6 5v.18L8.82 8h2.4l-.72 1.68 2.1 2.1L14.21 8H20V5H6z"})})})]}),e.jsx("div",{ref:r,contentEditable:!0,dir:b,onInput:m,onKeyDown:k,className:"min-h-[200px] p-4 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none prose prose-sm max-w-none dark:prose-invert",style:{textAlign:b==="rtl"?"right":"left"},"data-placeholder":i,suppressContentEditableWarning:!0}),e.jsx("style",{children:`
        .rich-text-editor [contenteditable]:empty:before {
          content: attr(data-placeholder);
          color: #9ca3af;
          pointer-events: none;
        }
        .rich-text-editor [contenteditable] h1 { font-size: 2em; font-weight: bold; margin: 0.5em 0; }
        .rich-text-editor [contenteditable] h2 { font-size: 1.5em; font-weight: bold; margin: 0.5em 0; }
        .rich-text-editor [contenteditable] h3 { font-size: 1.17em; font-weight: bold; margin: 0.5em 0; }
        .rich-text-editor [contenteditable] p { margin: 0.5em 0; }
        .rich-text-editor [contenteditable] ul, .rich-text-editor [contenteditable] ol { margin: 0.5em 0; padding-left: 1.5em; }
        .rich-text-editor [contenteditable] li { margin: 0.25em 0; }
        .rich-text-editor [contenteditable] a { color: #3b82f6; text-decoration: underline; }
      `})]})},pe=()=>{const[s,j]=a.useState(!1);return{translate:a.useCallback(async(v,b)=>{if(!v.trim())return"";j(!0);try{const r=await be("/translate",{method:"POST",body:JSON.stringify({text:v,context:b})});if(!r.ok)throw new Error("Translation request failed");return(await r.json()).translated_text||""}catch(r){return console.error("Translation Hook Error:",r),""}finally{j(!1)}},[]),isTranslating:s}},Ee=({children:s,color:j="gray",className:i})=>{const v={green:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",gray:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",blue:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300"};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v[j]} ${i}`,children:s})},ue=({isOpen:s,onClose:j,children:i,title:v})=>{const b=a.useRef(null),r=a.useRef(null);return a.useEffect(()=>{var m;if(!s)return;const x=h=>{var k;if(h.key==="Escape")j();else if(h.key==="Tab"){const c=(k=b.current)==null?void 0:k.querySelectorAll("a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled])");if(!c||c.length===0)return;const f=c[0],p=c[c.length-1];h.shiftKey?document.activeElement===f&&(p.focus(),h.preventDefault()):document.activeElement===p&&(f.focus(),h.preventDefault())}};return document.addEventListener("keydown",x),(m=r.current)==null||m.focus(),()=>{document.removeEventListener("keydown",x)}},[s,j]),s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 z-50 flex justify-center items-center p-4",onClick:j,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{ref:b,className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 flex justify-between items-center z-10",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:v}),e.jsx("button",{ref:r,onClick:j,className:"text-gray-400 hover:text-gray-600 dark:hover:text-white transition-colors","aria-label":"Close modal",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-6",children:i})]})}):null},ye=({isOpen:s,onClose:j,onConfirm:i,title:v,message:b})=>{const{t:r}=Y();return e.jsx(ue,{isOpen:s,onClose:j,title:v,children:e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-6",children:b}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx($,{variant:"secondary",onClick:j,children:r("dashboard.confirmDelete.cancel")}),e.jsx("button",{onClick:i,className:"px-8 py-3 rounded-lg font-bold text-sm uppercase tracking-wider transition-all duration-300 transform focus:outline-none focus:ring-4 focus:ring-opacity-50 bg-red-600 text-white shadow-lg hover:shadow-xl focus:ring-red-300 hover:-translate-y-0.5",children:r("dashboard.confirmDelete.confirm")})]})]})})},Ye=({value:s,onChange:j,onClose:i})=>{const[v,b]=a.useState([]),[r,x]=a.useState(!0),[m,h]=a.useState(!1),[k,c]=a.useState(0),[f,p]=a.useState(null),[y,E]=a.useState(s),[I,z]=a.useState(!1),M=a.useRef(null),U=a.useRef(!0);a.useEffect(()=>(U.current=!0,()=>{U.current=!1}),[]);const N=a.useCallback(async()=>{try{x(!0),p(null);const t=await Ce("image");U.current&&b(t.data||[])}catch(t){console.error("Failed to load media:",t),U.current&&p("Failed to load media library")}finally{U.current&&x(!1)}},[]);a.useEffect(()=>{N()},[N]);const L=async t=>{if(!t||t.length===0)return;const g=t[0];if(!g.type.startsWith("image/")){p("Please select an image file");return}if(g.size>10*1024*1024){p("File size must be less than 10MB");return}try{h(!0),c(0),p(null);const T=setInterval(()=>{c(S=>Math.min(S+10,90))},100),w=await Me(g);clearInterval(T),U.current&&w.media&&(c(100),b(S=>[w.media,...S]),E(w.media.url))}catch(T){console.error("Upload failed:",T),U.current&&p(T.message||"Upload failed")}finally{U.current&&(h(!1),c(0))}},F=t=>{t.preventDefault(),t.stopPropagation(),t.type==="dragenter"||t.type==="dragover"?z(!0):t.type==="dragleave"&&z(!1)},d=t=>{t.preventDefault(),t.stopPropagation(),z(!1),L(t.dataTransfer.files)},u=t=>{E(t.url)},o=()=>{y&&j(y),i()},D=()=>{i()},l=async(t,g,T)=>{if(T.stopPropagation(),!!window.confirm("Are you sure you want to delete this image?"))try{await Le(t),U.current&&(b(w=>w.filter(S=>S.id!==t)),y===g&&E(""))}catch(w){console.error("Delete failed:",w),U.current&&p("Failed to delete image")}},B=t=>t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(1)+" MB";return a.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:t=>{t.target===t.currentTarget&&D()},children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Media Library"}),e.jsx("button",{type:"button",onClick:D,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 text-2xl leading-none",children:"Ã—"})]}),e.jsx("div",{className:`m-4 p-6 border-2 border-dashed rounded-lg transition-colors ${I?"border-smart-blue bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"}`,onDragEnter:F,onDragLeave:F,onDragOver:F,onDrop:d,children:e.jsxs("div",{className:"text-center",children:[m?e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"w-8 h-8 mx-auto text-smart-blue"}),e.jsx("div",{className:"w-48 h-2 bg-gray-200 rounded-full mx-auto overflow-hidden",children:e.jsx("div",{className:"h-full bg-smart-blue transition-all duration-300",style:{width:`${k}%`}})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:["Drag and drop an image here, or"," ",e.jsx("button",{type:"button",onClick:()=>{var t;return(t=M.current)==null?void 0:t.click()},className:"text-smart-blue hover:underline font-medium",children:"browse"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Supports: JPG, PNG, GIF, WebP (max 10MB)"})]}),e.jsx("input",{ref:M,type:"file",accept:"image/*",onChange:t=>{L(t.target.files),t.target.value=""},className:"hidden"})]})}),f&&e.jsx("div",{className:"mx-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:f})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 min-h-[200px]",children:r?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ae,{className:"w-8 h-8 text-smart-blue"})}):v.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{children:"No images uploaded yet"}),e.jsx("p",{className:"text-sm",children:"Upload your first image above"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:v.map(t=>e.jsxs("div",{onClick:()=>u(t),className:`relative group cursor-pointer rounded-lg overflow-hidden border-2 transition-all ${y===t.url?"border-smart-blue ring-2 ring-smart-blue ring-opacity-50":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx("div",{className:"aspect-square bg-gray-100 dark:bg-gray-700",children:e.jsx("img",{src:t.url,alt:t.alt_text||t.original_name,className:"w-full h-full object-cover",loading:"lazy"})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all flex items-center justify-center",children:e.jsx("button",{type:"button",onClick:g=>l(t.id,t.url,g),className:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition-all",title:"Delete",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),y===t.url&&e.jsx("div",{className:"absolute top-2 right-2 bg-smart-blue text-white rounded-full p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("p",{className:"text-white text-xs truncate",children:t.original_name}),e.jsx("p",{className:"text-gray-300 text-xs",children:B(t.size)})]})]},t.id))})}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:[e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[v.length," ",v.length===1?"image":"images"," in library"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:D,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:o,disabled:!y,className:"px-4 py-2 text-sm font-medium text-white bg-smart-blue rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Select Image"})]})]})]})})},Se=()=>{const{posts:s,deletePost:j,updatePost:i,addPost:v}=a.useContext(ne),{user:b}=oe(),{t:r,language:x}=Y(),{translate:m}=pe(),[h,k]=a.useState("list"),[c,f]=a.useState(null),[p,y]=a.useState(""),[E,I]=a.useState("all"),[z,M]=a.useState(null),U={title:{ar:"",en:""},excerpt:{ar:"",en:""},content:{ar:"",en:""},imageUrl:"",status:"draft"},[N,L]=a.useState(U),[F,d]=a.useState(!1),[u,o]=a.useState({}),[D,l]=a.useState({title:!1,excerpt:!1,content:!1}),[B,t]=a.useState(!1),[g,T]=a.useState(()=>localStorage.getItem("autoTranslateEnabled")!=="false"),w=a.useRef(null),S=a.useRef(null);a.useEffect(()=>{h==="add"&&(L(c?{title:c.title,excerpt:c.excerpt,content:c.content,imageUrl:c.imageUrl,status:c.status}:U),o({}))},[h,c]),a.useEffect(()=>()=>{w.current&&clearTimeout(w.current)},[]);const K=a.useMemo(()=>{let n=s;return b&&b.role==="employee"&&(n=s.filter(C=>C.author===b.email)),n.filter(C=>(x==="ar"?C.title.ar:C.title.en).toLowerCase().includes(p.toLowerCase())).filter(C=>E==="all"?!0:C.status===E)},[s,p,E,x,b]),O=n=>{f(n),k("add")},R=()=>{f(null),k("add")},H=n=>{M(n)},q=async()=>{z&&(await j(z.id),M(null))},G=async n=>{const C=n.status==="published"?"draft":"published";await i({...n,status:C})},X=()=>{const n={title:{},excerpt:{},content:{}};let C=!0;return N.title.en.trim()||(n.title.en=r("contact.validation.fieldRequired"),C=!1),N.title.ar.trim()||(n.title.ar=r("contact.validation.fieldRequired"),C=!1),N.excerpt.en.trim()||(n.excerpt.en=r("contact.validation.fieldRequired"),C=!1),N.excerpt.ar.trim()||(n.excerpt.ar=r("contact.validation.fieldRequired"),C=!1),N.content.en.trim()||(n.content.en=r("contact.validation.fieldRequired"),C=!1),N.content.ar.trim()||(n.content.ar=r("contact.validation.fieldRequired"),C=!1),N.imageUrl.trim()||(n.imageUrl=r("contact.validation.fieldRequired"),C=!1),o(n),C},Q=n=>{const{name:C,value:P}=n.target;if(S.current=C,C.includes(".")){const[W,Z]=C.split(".");L(_=>({..._,[W]:{..._[W],[Z]:P}}))}else L(W=>({...W,[C]:P}));if(!g||(w.current&&clearTimeout(w.current),!C.includes(".")))return;const[A,V]=C.split(".");if(!P.trim()){l(W=>({...W,[A]:!1}));return}l(W=>({...W,[A]:!0})),w.current=window.setTimeout(async()=>{if(S.current!==C){l(J=>({...J,[A]:!1}));return}const W=V==="ar"?"en":"ar",Z=`a blog post ${A}`,_=await m(P,Z);_&&S.current===C&&L(J=>{const xe=P;return J[A][V]===xe?{...J,[A]:{...J[A],[W]:_}}:J}),l(J=>({...J,[A]:!1}))},800)},le=(n,C,P)=>{const A=`${n}.${C}`;if(S.current=A,L(V=>({...V,[n]:{...V[n],[C]:P}})),!!g){if(w.current&&clearTimeout(w.current),!P.trim()||P==="<p><br></p>"){l(V=>({...V,[n]:!1}));return}l(V=>({...V,[n]:!0})),w.current=window.setTimeout(async()=>{if(S.current!==A){l(_=>({..._,[n]:!1}));return}const V=C==="ar"?"en":"ar",W=`a blog post ${n} in HTML format. Keep the HTML tags (like <p>, <strong>, <ul>, etc.) exactly as they are and only translate the text content inside them.`,Z=await m(P,W);Z&&S.current===A&&L(_=>_[n][C]===P?{..._,[n]:{..._[n],[V]:Z}}:_),l(_=>({..._,[n]:!1}))},1e3)}},de=async n=>{const C=N[n].en.trim(),P=N[n].ar.trim();if(!(!C&&!P)){l(A=>({...A,[n]:!0}));try{const A=`a blog post ${n}`;if(C&&!P){const V=await m(C,A);V&&L(W=>({...W,[n]:{...W[n],ar:V}}))}else if(P&&!C){const V=await m(P,A);V&&L(W=>({...W,[n]:{...W[n],en:V}}))}else if(C){const V=await m(C,A);V&&L(W=>({...W,[n]:{...W[n],ar:V}}))}}catch(A){console.error("Translation failed:",A)}finally{l(A=>({...A,[n]:!1}))}}},fe=async(n,C=!1)=>{if(n.preventDefault(),!X()||!b)return;const P={...N,status:C?"draft":N.status};d(!0);try{c?await i({...c,...P}):await v(P,b.email),L(U),f(null),k("list")}catch(A){console.error("Failed to save post",A),alert("Could not save post. Please try again.")}finally{d(!1)}},je=()=>{L(U),f(null),k("list")},ce=n=>`w-full px-3 py-2 border rounded-lg focus:outline-none transition duration-150 ease-in-out bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400 ${n?"border-red-400 focus:ring-2 focus:ring-red-200":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-smart-blue"}`,he=(n,C,P="input")=>{var _,J,xe,me;const A=P==="input"?"input":"textarea",V=P==="textarea"?n==="excerpt"?3:6:void 0,W=N[n].en.trim()||N[n].ar.trim(),Z=n==="content";return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[C,D[n]&&e.jsx(ae,{className:"inline-block ml-2 h-4 w-4 text-smart-blue"})]}),!g&&W&&e.jsxs("button",{type:"button",onClick:()=>de(n),disabled:D[n],className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-smart-blue hover:text-smart-blue-dark bg-blue-50 dark:bg-blue-900/30 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors disabled:opacity-50",children:[e.jsx(ie,{className:"h-3 w-3"}),D[n]?"Translating...":"Translate"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"English"}),e.jsx(ie,{className:"h-3 w-3 text-gray-400"})]}),Z?e.jsx(Ne,{value:N[n].en,onChange:ge=>le(n,"en",ge),placeholder:`Enter ${n} in English...`,dir:"ltr"}):e.jsx(A,{name:`${n}.en`,value:N[n].en,onChange:Q,rows:V,className:ce((_=u[n])==null?void 0:_.en),placeholder:`Enter ${n} in English...`}),((J=u[n])==null?void 0:J.en)&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:u[n].en})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"}),e.jsx(ie,{className:"h-3 w-3 text-gray-400"})]}),Z?e.jsx(Ne,{value:N[n].ar,onChange:ge=>le(n,"ar",ge),placeholder:`Ø£Ø¯Ø®Ù„ ${n==="title"?"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†":n==="excerpt"?"Ø§Ù„Ù…Ù‚ØªØ·Ù":"Ø§Ù„Ù…Ø­ØªÙˆÙ‰"} Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©...`,dir:"rtl"}):e.jsx(A,{name:`${n}.ar`,value:N[n].ar,onChange:Q,dir:"rtl",rows:V,className:ce((xe=u[n])==null?void 0:xe.ar),placeholder:`Ø£Ø¯Ø®Ù„ ${n==="title"?"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†":n==="excerpt"?"Ø§Ù„Ù…Ù‚ØªØ·Ù":"Ø§Ù„Ù…Ø­ØªÙˆÙ‰"} Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©...`}),((me=u[n])==null?void 0:me.ar)&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:u[n].ar})]})]})]})},De=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:r("dashboard.posts.title")}),e.jsx($,{onClick:R,children:r("dashboard.posts.addPost")})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[e.jsx("input",{type:"text",placeholder:r("dashboard.posts.searchPlaceholder"),value:p,onChange:n=>y(n.target.value),className:"w-full md:w-1/3 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"}),e.jsxs("select",{value:E,onChange:n=>I(n.target.value),className:"w-full md:w-auto px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 bg-white dark:bg-gray-700 dark:text-white dark:border-gray-600",children:[e.jsx("option",{value:"all",children:r("dashboard.posts.all")}),e.jsx("option",{value:"published",children:r("dashboard.posts.published")}),e.jsx("option",{value:"draft",children:r("dashboard.posts.draft")})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:r("dashboard.posts.table.title")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:r("dashboard.posts.table.author")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:r("dashboard.posts.table.status")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:r("dashboard.posts.table.date")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:r("dashboard.posts.table.actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:K.length>0?K.map(n=>e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 dark:odd:bg-gray-800 dark:even:bg-black/10",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:r(n.title)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:n.author}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx(Ee,{color:n.status==="published"?"green":"gray",children:r(`dashboard.posts.${n.status}`)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:n.date}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2 rtl:space-x-reverse",children:[e.jsx("button",{onClick:()=>G(n),className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300",title:r("dashboard.posts.toggleStatus"),children:n.status==="published"?r("dashboard.posts.unpublish"):r("dashboard.posts.publish")}),e.jsx("button",{onClick:()=>O(n),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:r("dashboard.posts.edit")}),e.jsx("button",{onClick:()=>H(n),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:r("dashboard.posts.delete")})]})]},n.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-10 text-gray-500 dark:text-gray-400",children:r("dashboard.posts.noPosts")})})})]})})]}),Fe=()=>{var n,C,P;return e.jsxs("div",{className:"max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:r(c?"dashboard.postForm.editTitle":"dashboard.postForm.addTitle")}),e.jsx("button",{onClick:je,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:r("dashboard.postsTabs.backToPosts")})]}),e.jsxs("form",{onSubmit:A=>fe(A,!1),className:"space-y-6",children:[he("title",((n=r("dashboard.postForm.titleEn"))==null?void 0:n.replace(" (English)",""))||"Title","input"),he("excerpt",((C=r("dashboard.postForm.excerptEn"))==null?void 0:C.replace(" (English)",""))||"Excerpt","textarea"),he("content",((P=r("dashboard.postForm.contentEn"))==null?void 0:P.replace(" (English)",""))||"Content","textarea"),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("dashboard.postForm.headerImage")}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx("div",{className:"w-32 h-20 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",children:N.imageUrl?e.jsx("img",{src:N.imageUrl,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs text-gray-400",children:"No Image"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",name:"imageUrl",value:N.imageUrl,onChange:Q,placeholder:"https://example.com/image.jpg",className:ce(u.imageUrl)+" flex-1"}),e.jsxs("button",{type:"button",onClick:()=>t(!0),className:"px-4 py-2 text-sm font-medium bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Browse"]})]}),u.imageUrl&&e.jsx("p",{className:"text-red-600 text-xs",children:u.imageUrl}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Enter URL or browse media library"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:r("dashboard.postForm.status")}),e.jsxs("select",{name:"status",value:N.status,onChange:Q,className:ce()+" max-w-xs",children:[e.jsx("option",{value:"draft",children:r("dashboard.posts.draft")}),e.jsx("option",{value:"published",children:r("dashboard.posts.published")})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx($,{variant:"secondary",onClick:je,type:"button",children:r("dashboard.postForm.cancel")}),e.jsx($,{variant:"secondary",type:"button",disabled:F,onClick:A=>fe(A,!0),children:"Save as Draft"}),e.jsx($,{type:"submit",disabled:F,className:"min-w-[120px]",children:F?e.jsx(ee,{className:"h-5 w-5 text-white"}):c?r("dashboard.postForm.save"):"Publish"})]})]})]})};return e.jsxs(te,{children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:e.jsxs("nav",{className:"flex space-x-8 rtl:space-x-reverse","aria-label":"Tabs",children:[e.jsxs("button",{onClick:()=>{k("list"),f(null)},className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${h==="list"?"border-smart-blue text-smart-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400"}`,children:["ðŸ“‹ ",r("dashboard.postsTabs.allPosts")]}),e.jsxs("button",{onClick:()=>{k("add"),f(null)},className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${h==="add"&&!c?"border-smart-blue text-smart-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400"}`,children:["âž• ",r("dashboard.postsTabs.addNew")]}),c&&e.jsxs("span",{className:"py-3 px-1 border-b-2 border-smart-blue text-smart-blue font-medium text-sm",children:["âœï¸ ",r("dashboard.postsTabs.editing")," ",x==="ar"?c.title.ar.substring(0,20):c.title.en.substring(0,20),"..."]})]})}),h==="list"&&De(),h==="add"&&Fe(),z&&e.jsx(ye,{isOpen:!!z,onClose:()=>M(null),onConfirm:q,title:r("dashboard.confirmDelete.title"),message:r("dashboard.confirmDelete.messagePost")}),B&&e.jsx(Ye,{value:N.imageUrl,onChange:n=>L(C=>({...C,imageUrl:n})),onClose:()=>t(!1)})]})},Je="smartstep.ly",Qe=({isOpen:s,onClose:j,user:i})=>{const{addUser:v,updateUser:b,users:r}=a.useContext(ne),{t:x,language:m}=Y(),{generateAndShowEmail:h}=oe(),k={email:"",password:"",role:"employee"},[c,f]=a.useState(k),[p,y]=a.useState(!1),[E,I]=a.useState({});a.useEffect(()=>{f(i?{email:i.email,password:"",role:i.role}:k),I({})},[i,s]);const z=()=>{const L={};let F=!0;return c.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.email)?r.some(d=>d.email.toLowerCase()===c.email.toLowerCase()&&d.id!==(i==null?void 0:i.id))?(L.email=x("dashboard.userForm.emailExists"),F=!1):c.email.endsWith(`@${Je}`)&&(L.email=x("dashboard.userForm.emailDomainRestricted"),F=!1):(L.email=x("contact.validation.invalidEmail"),F=!1):(L.email=x("contact.validation.fieldRequired"),F=!1),!i&&!c.password?(L.password=x("contact.validation.fieldRequired"),F=!1):c.password&&c.password.length<8&&(L.password=x("resetPasswordPage.validation.passwordLength"),F=!1),I(L),F},M=L=>{const{name:F,value:d}=L.target;f(u=>({...u,[F]:d}))},U=async L=>{if(L.preventDefault(),!z())return;y(!0);const F={email:c.email,role:c.role,...c.password&&{password:c.password}};try{if(i)await b({...i,...F,password:c.password||i.password});else{const d=await v(F);if(d){const u=`${window.location.origin}${window.location.pathname}#/verify-email/${d}`;await h("new-user",{verificationLink:u},m)}}j()}catch(d){console.error("Failed to save user",d),alert("Could not save user. Please try again.")}finally{y(!1)}},N=L=>`w-full px-3 py-2 border rounded-lg focus:outline-none transition duration-150 ease-in-out bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400 ${L?"border-red-400 focus:ring-2 focus:ring-red-200":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-smart-blue"}`;return e.jsx(ue,{isOpen:s,onClose:j,title:x(i?"dashboard.userForm.editTitle":"dashboard.userForm.addTitle"),children:e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("dashboard.userForm.email")}),e.jsx("input",{id:"email",type:"email",name:"email",value:c.email,onChange:M,className:N(E.email),"aria-describedby":E.email?"email-error":void 0}),E.email&&e.jsx("p",{id:"email-error",className:"text-red-600 text-xs mt-1",role:"alert",children:E.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("dashboard.userForm.password")}),e.jsx("input",{id:"password",type:"password",name:"password",value:c.password,onChange:M,className:N(E.password),"aria-describedby":E.password?"password-error":void 0}),E.password&&e.jsx("p",{id:"password-error",className:"text-red-600 text-xs mt-1",role:"alert",children:E.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("dashboard.userForm.role")}),e.jsxs("select",{id:"role",name:"role",value:c.role,onChange:M,className:N(),children:[e.jsx("option",{value:"employee",children:x("dashboard.users.roleEmployee")}),e.jsx("option",{value:"admin",children:x("dashboard.users.roleAdmin")})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-4",children:[e.jsx($,{variant:"secondary",onClick:j,type:"button",children:x("dashboard.userForm.cancel")}),e.jsx($,{type:"submit",disabled:p,className:"flex items-center justify-center min-w-[120px]",children:p?e.jsx(ee,{className:"h-5 w-5 text-white"}):x("dashboard.userForm.save")})]})]})})},Ze="arbh.ly@gmail.com",et=()=>{const{users:s,deleteUser:j}=a.useContext(ne),{t:i}=Y(),[v,b]=a.useState(!1),[r,x]=a.useState(null),[m,h]=a.useState(null),k=y=>{x(y),b(!0)},c=()=>{x(null),b(!0)},f=y=>{h(y)},p=async()=>{m&&(await j(m.id),h(null))};return e.jsxs(te,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:i("dashboard.users.title")}),e.jsx($,{onClick:c,children:i("dashboard.users.addUser")})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:i("dashboard.users.table.email")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:i("dashboard.users.table.role")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:i("dashboard.users.table.actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.length>0?s.map(y=>{const E=y.email===Ze;return e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 dark:odd:bg-gray-800 dark:even:bg-black/10",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:y.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx(Ee,{color:y.role==="Super admin"?"purple":y.role==="admin"?"blue":"gray",children:y.role==="Super admin"?"Super Admin":i(y.role==="admin"?"dashboard.users.roleAdmin":"dashboard.users.roleEmployee")})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2 rtl:space-x-reverse",children:[e.jsx("button",{onClick:()=>k(y),className:`text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 ${E?"opacity-50 cursor-not-allowed":""}`,disabled:E,children:i("dashboard.users.edit")}),e.jsx("button",{onClick:()=>f(y),className:`text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 ${E?"opacity-50 cursor-not-allowed":""}`,disabled:E,children:i("dashboard.users.delete")})]})]},y.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"text-center py-10 text-gray-500 dark:text-gray-400",children:i("dashboard.users.noUsers")})})})]})}),v&&e.jsx(Qe,{isOpen:v,onClose:()=>b(!1),user:r}),m&&e.jsx(ye,{isOpen:!!m,onClose:()=>h(null),onConfirm:p,title:i("dashboard.confirmDelete.title"),message:i("dashboard.confirmDelete.messageUser")})]})},se=8,re=128,tt=({isOpen:s,onClose:j,onSave:i,imageSrc:v})=>{const b=a.useRef(null),r=a.useRef(null),x=a.useRef(null),[m,h]=a.useState({x:10,y:10,width:100,height:100}),[k,c]=a.useState(!1),[f,p]=a.useState(null),[y,E]=a.useState({x:0,y:0}),I=(t,g)=>{const T=b.current;if(!T)return{x:0,y:0};const w=T.getBoundingClientRect();return{x:t-w.left,y:g-w.top}},z=()=>{const t=b.current,g=t==null?void 0:t.getContext("2d"),T=x.current;if(!t||!g||!T)return;g.clearRect(0,0,t.width,t.height),g.drawImage(T,0,0,t.width,t.height),g.fillStyle="rgba(0, 0, 0, 0.5)",g.fillRect(0,0,t.width,t.height),g.clearRect(m.x,m.y,m.width,m.height),g.strokeStyle="#fff",g.lineWidth=2,g.strokeRect(m.x,m.y,m.width,m.height),g.fillStyle="#fff";const w=U(m);Object.values(w).forEach(S=>{g.fillRect(S.x-se/2,S.y-se/2,se,se)}),M()},M=()=>{const t=r.current,g=t==null?void 0:t.getContext("2d"),T=x.current,w=b.current;if(!t||!g||!T||!w)return;g.clearRect(0,0,t.width,t.height);const S=T.naturalWidth/w.width,K=T.naturalHeight/w.height;g.drawImage(T,m.x*S,m.y*K,m.width*S,m.height*K,0,0,t.width,t.height)};a.useEffect(()=>{const t=new Image;t.src=v,t.onload=()=>{x.current=t;const g=b.current;if(!g)return;const T=t.naturalWidth/t.naturalHeight,w=350;g.width=w,g.height=w/T;const S=Math.min(g.width,g.height)*.8;h({x:(g.width-S)/2,y:(g.height-S)/2,width:S,height:S})}},[v]),a.useEffect(()=>{x.current&&z()},[m,x.current]);const U=t=>({tl:{x:t.x,y:t.y},tr:{x:t.x+t.width,y:t.y},bl:{x:t.x,y:t.y+t.height},br:{x:t.x+t.width,y:t.y+t.height}}),N=(t,g)=>{const T=U(g);for(const w in T){const S=T[w];if(Math.abs(t.x-S.x)<se&&Math.abs(t.y-S.y)<se)return w}return null},L=t=>{const g=N(t,m);g?p(g):t.x>m.x&&t.x<m.x+m.width&&t.y>m.y&&t.y<m.y+m.height&&c(!0),E(t)},F=t=>{const g=b.current;if(!g)return;const T=t.x-y.x,w=t.y-y.y;k?h(S=>({...S,x:Math.max(0,Math.min(S.x+T,g.width-S.width)),y:Math.max(0,Math.min(S.y+w,g.height-S.height))})):f&&h(S=>{let{x:K,y:O,width:R,height:H}=S,q=R,G=H;f.includes("r")&&(q=R+T),f.includes("l")&&(q=R-T,K+=T),f.includes("b")&&(G=H+w),f.includes("t")&&(G=H-w,O+=w);const X=Math.max(q,G);return f.includes("l")&&(K=S.x+S.width-X),f.includes("t")&&(O=S.y+S.height-X),R=X,H=X,K<0&&(K=0,R=S.width+S.x),O<0&&(O=0,H=S.height+S.y),K+R>g.width&&(R=g.width-K,H=R),O+H>g.height&&(H=g.height-O,R=H),{x:K,y:O,width:R,height:H}}),E(t)},d=()=>{c(!1),p(null)},u=t=>L(I(t.clientX,t.clientY)),o=t=>F(I(t.clientX,t.clientY)),D=t=>L(I(t.touches[0].clientX,t.touches[0].clientY)),l=t=>F(I(t.touches[0].clientX,t.touches[0].clientY)),B=()=>{const t=b.current,g=x.current;if(!t||!g)return;const T=document.createElement("canvas");T.width=re,T.height=re;const w=T.getContext("2d");if(!w)return;const S=g.naturalWidth/t.width,K=g.naturalHeight/t.height;w.drawImage(g,m.x*S,m.y*K,m.width*S,m.height*K,0,0,re,re),i(T.toDataURL("image/png"))};return s?e.jsx(ue,{isOpen:s,onClose:j,title:"Crop Logo",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsx("div",{className:"flex-grow",children:e.jsx("canvas",{ref:b,className:"cursor-move border border-gray-300 dark:border-gray-600",onMouseDown:u,onMouseMove:o,onMouseUp:d,onMouseLeave:d,onTouchStart:D,onTouchMove:l,onTouchEnd:d})}),e.jsxs("div",{className:"flex-shrink-0 text-center space-y-2",children:[e.jsx("p",{className:"font-semibold text-sm",children:"Live Preview"}),e.jsx("canvas",{ref:r,width:re,height:re,className:"border-2 border-dashed border-gray-400 dark:border-gray-500 rounded-md"}),e.jsxs("div",{className:"flex gap-2 justify-center pt-4",children:[e.jsx($,{variant:"secondary",onClick:j,children:"Cancel"}),e.jsx($,{onClick:B,children:"Save"})]})]})]})}):null},at=()=>{const{siteInfo:s,updateSiteInfo:j}=a.useContext(ne),{user:i}=oe(),{t:v}=Y(),{translate:b}=pe(),[r,x]=a.useState(s),[m,h]=a.useState(!1),[k,c]=a.useState(!1),[f,p]=a.useState(!1),[y,E]=a.useState({isOpen:!1,imageSrc:""}),[I,z]=a.useState(()=>localStorage.getItem("autoTranslateEnabled")!=="false"),[M,U]=a.useState(""),[N,L]=a.useState(!1),[F,d]=a.useState("idle"),u=a.useRef(null),o=a.useRef(null),D=a.useRef(null),l=(i==null?void 0:i.role)==="Super admin";a.useEffect(()=>{x(s)},[s]),a.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]);const B=()=>{const R=!I;z(R),localStorage.setItem("autoTranslateEnabled",String(R))},t=async()=>{if(M.trim()){d("saving");try{await be("/settings",{method:"PUT",body:JSON.stringify({settings:[{key:"gemini_api_key",value:M,group:"translation"}]})}),d("saved"),setTimeout(()=>d("idle"),3e3)}catch(R){console.error("Failed to save API key:",R),d("error")}}},g=async()=>{d("saving");try{await be("/settings",{method:"PUT",body:JSON.stringify({settings:[{key:"gemini_api_key",value:"",group:"translation"}]})}),U(""),d("idle")}catch(R){console.error("Failed to delete API key:",R),d("error")}},T=R=>{const{name:H,value:q}=R.target;if(D.current=H,H.includes(".")){const[G,X]=H.split(".");x(Q=>({...Q,[G]:{...Q[G],[X]:q}}))}else x(G=>({...G,[H]:q}));if(I&&(o.current&&clearTimeout(o.current),!!H.includes("."))){if(!q.trim()){p(!1);return}p(!0),o.current=window.setTimeout(async()=>{if(D.current!==H){p(!1);return}const[G,X]=H.split("."),Q=X==="ar"?"en":"ar",le=await b(q,"a business address");le&&D.current===H&&x(de=>({...de,address:{...de.address,[Q]:le}})),p(!1)},800)}},w=R=>{R.preventDefault(),h(!0),setTimeout(()=>{j(r),h(!1),c(!0),setTimeout(()=>c(!1),3e3)},1e3)},S=R=>{if(R.target.files&&R.target.files[0]){const H=R.target.files[0],q=new FileReader;q.onload=G=>{var X;E({isOpen:!0,imageSrc:(X=G.target)==null?void 0:X.result})},q.readAsDataURL(H),R.target.value=""}},K=R=>{x(H=>({...H,logoUrl:R})),E({isOpen:!1,imageSrc:""})},O=()=>"w-full px-3 py-2 border rounded-lg focus:outline-none transition duration-150 ease-in-out bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400 border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-smart-blue";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(te,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:v("dashboard.settings.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:v("dashboard.settings.subtitle")})]}),e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Website Logo"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 dark:bg-gray-700 border dark:border-gray-600 rounded-md flex items-center justify-center overflow-hidden",children:r.logoUrl?e.jsx("img",{src:r.logoUrl,alt:"Logo Preview",className:"max-w-full max-h-full object-contain"}):e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 p-2 text-center",children:"No Logo"})}),e.jsx("input",{type:"file",accept:"image/png, image/jpeg, image/svg+xml",ref:u,onChange:S,hidden:!0}),e.jsx($,{type:"button",variant:"secondary",onClick:()=>{var R;return(R=u.current)==null?void 0:R.click()},children:"Upload Logo"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 relative",children:[e.jsx("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 rtl:translate-x-1/2 flex items-center justify-center h-5 w-5 bg-gray-100 dark:bg-gray-600 rounded-full border dark:border-gray-500 z-10",children:f?e.jsx(ae,{className:"h-4 w-4 text-smart-blue"}):e.jsx(ie,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v("dashboard.settings.addressEn")}),e.jsx("input",{type:"text",name:"address.en",value:r.address.en,onChange:T,className:O()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v("dashboard.settings.addressAr")}),e.jsx("input",{type:"text",name:"address.ar",value:r.address.ar,onChange:T,dir:"rtl",className:O()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v("dashboard.settings.phone")}),e.jsx("input",{type:"text",name:"phone",value:r.phone,onChange:T,className:O()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v("dashboard.settings.email")}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:T,className:O()})]}),e.jsxs("div",{className:"pt-4 flex items-center gap-4",children:[e.jsx($,{type:"submit",disabled:m,className:"flex items-center justify-center min-w-[120px]",children:m?e.jsx(ee,{className:"h-5 w-5 text-white"}):v("dashboard.settings.save")}),k&&e.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400 transition-opacity duration-300",children:[e.jsx(Re,{className:"h-5 w-5"}),e.jsx("span",{children:v("dashboard.settings.success")})]})]})]})]}),e.jsxs(te,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Translation Settings"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Configure automatic translation behavior"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Auto-Translate Content"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Automatically translate content as you type"})]}),e.jsx("button",{type:"button",onClick:B,className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-smart-blue focus:ring-offset-2 ${I?"bg-smart-blue":"bg-gray-300 dark:bg-gray-600"}`,children:e.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${I?"translate-x-5":"translate-x-0"}`})})]}),l&&e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Gemini API Key (Super Admin Only)"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:N?"text":"password",value:M,onChange:R=>U(R.target.value),placeholder:"Enter your Gemini API key",className:O()}),e.jsx("button",{type:"button",onClick:()=>L(!N),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:N?"ðŸ™ˆ":"ðŸ‘"})]})}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx($,{type:"button",onClick:t,disabled:!M.trim()||F==="saving",className:"text-sm",children:F==="saving"?"Saving...":F==="saved"?"âœ“ Saved":"Save Key"}),e.jsx($,{type:"button",variant:"secondary",onClick:g,className:"text-sm",children:"Delete Key"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Get your API key from ",e.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-smart-blue hover:underline",children:"Google AI Studio"})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Note:"})," When auto-translate is enabled, content will be automatically translated as you type in either language field. The translation uses Google's Gemini AI."]})})]})]})]}),y.isOpen&&e.jsx(tt,{isOpen:y.isOpen,onClose:()=>E({isOpen:!1,imageSrc:""}),imageSrc:y.imageSrc,onSave:K})]})},st=({isOpen:s,onClose:j,member:i})=>{const{addTeamMember:v,updateTeamMember:b}=a.useContext(ne),{t:r}=Y(),{translate:x}=pe(),m={name:{ar:"",en:""},role:{ar:"",en:""},imageUrl:""},[h,k]=a.useState(m),[c,f]=a.useState(!1),[p,y]=a.useState({}),[E,I]=a.useState({name:!1,role:!1}),z=a.useRef(null),M=a.useRef(null);a.useEffect(()=>{k(i?{name:i.name,role:i.role,imageUrl:i.imageUrl}:m),y({}),I({name:!1,role:!1})},[i,s]),a.useEffect(()=>()=>{z.current&&clearTimeout(z.current)},[]);const U=()=>{const u={name:{},role:{}};let o=!0;return h.name.en.trim()||(u.name.en=r("contact.validation.fieldRequired"),o=!1),h.name.ar.trim()||(u.name.ar=r("contact.validation.fieldRequired"),o=!1),h.role.en.trim()||(u.role.en=r("contact.validation.fieldRequired"),o=!1),h.role.ar.trim()||(u.role.ar=r("contact.validation.fieldRequired"),o=!1),h.imageUrl.trim()||(u.imageUrl=r("contact.validation.fieldRequired"),o=!1),y(u),o},N=u=>{const{name:o,value:D}=u.target;if(M.current=o,o.includes(".")){const[t,g]=o.split(".");k(T=>({...T,[t]:{...T[t],[g]:D}}))}else k(t=>({...t,[o]:D}));if(z.current&&clearTimeout(z.current),!o.includes("."))return;const[l,B]=o.split(".");if(!D.trim()){I(t=>({...t,[l]:!1}));return}I(t=>({...t,[l]:!0})),z.current=window.setTimeout(async()=>{if(M.current!==o){I(w=>({...w,[l]:!1}));return}const t=B==="ar"?"en":"ar",g=`a team member's ${l}`,T=await x(D,g);T&&M.current===o&&k(w=>({...w,[l]:{...w[l],[t]:T}})),I(w=>({...w,[l]:!1}))},800)},L=u=>{u.preventDefault(),U()&&(f(!0),setTimeout(()=>{i?b({...i,...h}):v(h),f(!1),j()},1e3))},F=u=>`w-full px-3 py-2 border rounded-lg focus:outline-none transition duration-150 ease-in-out bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400 ${u?"border-red-400 focus:ring-2 focus:ring-red-200":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-smart-blue"}`,d=u=>{var o,D,l,B,t,g;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 relative",children:[e.jsx("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 rtl:translate-x-1/2 flex items-center justify-center h-5 w-5 bg-gray-100 dark:bg-gray-600 rounded-full border dark:border-gray-500 z-10",children:E[u]?e.jsx(ae,{}):e.jsx(ie,{})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`${u}-en`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r(`dashboard.teamForm.${u}En`)}),e.jsx("input",{type:"text",id:`${u}-en`,name:`${u}.en`,value:h[u].en,onChange:N,className:F((o=p[u])==null?void 0:o.en),"aria-describedby":(D=p[u])!=null&&D.en?`${u}-en-error`:void 0}),((l=p[u])==null?void 0:l.en)&&e.jsx("p",{id:`${u}-en-error`,className:"text-red-600 text-xs mt-1",role:"alert",children:p[u].en})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`${u}-ar`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r(`dashboard.teamForm.${u}Ar`)}),e.jsx("input",{type:"text",id:`${u}-ar`,name:`${u}.ar`,value:h[u].ar,onChange:N,dir:"rtl",className:F((B=p[u])==null?void 0:B.ar),"aria-describedby":(t=p[u])!=null&&t.ar?`${u}-ar-error`:void 0}),((g=p[u])==null?void 0:g.ar)&&e.jsx("p",{id:`${u}-ar-error`,className:"text-red-600 text-xs mt-1",role:"alert",children:p[u].ar})]})]})};return e.jsx(ue,{isOpen:s,onClose:j,title:r(i?"dashboard.teamForm.editTitle":"dashboard.teamForm.addTitle"),children:e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[d("name"),d("role"),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("dashboard.teamForm.imageUrl")}),e.jsx("input",{id:"imageUrl",type:"text",name:"imageUrl",value:h.imageUrl,onChange:N,className:F(p.imageUrl),"aria-describedby":p.imageUrl?"imageUrl-error":void 0}),p.imageUrl&&e.jsx("p",{id:"imageUrl-error",className:"text-red-600 text-xs mt-1",role:"alert",children:p.imageUrl})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-4",children:[e.jsx($,{variant:"secondary",onClick:j,type:"button",children:r("dashboard.teamForm.cancel")}),e.jsx($,{type:"submit",disabled:c,className:"flex items-center justify-center min-w-[120px]",children:c?e.jsx(ee,{}):r(i?"dashboard.teamForm.save":"dashboard.teamForm.addTitle")})]})]})})},rt=()=>{const{teamMembers:s,deleteTeamMember:j}=a.useContext(ne),{t:i}=Y(),[v,b]=a.useState(!1),[r,x]=a.useState(null),[m,h]=a.useState(null),k=y=>{x(y),b(!0)},c=()=>{x(null),b(!0)},f=y=>{h(y)},p=()=>{m&&(j(m.id),h(null))};return e.jsxs(te,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:i("dashboard.team.title")}),e.jsx($,{onClick:c,children:i("dashboard.team.addMember")})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:i("dashboard.team.table.photo")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:i("dashboard.team.table.name")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:i("dashboard.team.table.role")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:i("dashboard.team.table.actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.length>0?s.map(y=>e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 dark:odd:bg-gray-800 dark:even:bg-black/10",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:y.imageUrl,alt:i(y.name)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:i(y.name)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:i(y.role)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2 rtl:space-x-reverse",children:[e.jsx("button",{onClick:()=>k(y),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:i("dashboard.team.edit")}),e.jsx("button",{onClick:()=>f(y),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:i("dashboard.team.delete")})]})]},y.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-10 text-gray-500 dark:text-gray-400",children:i("dashboard.team.noMembers")})})})]})}),v&&e.jsx(st,{isOpen:v,onClose:()=>b(!1),member:r}),m&&e.jsx(ye,{isOpen:!!m,onClose:()=>h(null),onConfirm:p,title:i("dashboard.confirmDelete.title"),message:i("dashboard.confirmDelete.messageTeamMember")})]})},nt=[{value:"all",labelKey:"dashboard.messages.filter.all"},{value:"new",labelKey:"dashboard.messages.filter.new"},{value:"read",labelKey:"dashboard.messages.filter.read"},{value:"archived",labelKey:"dashboard.messages.filter.archived"}],lt=()=>{const{t:s}=Y(),[j,i]=a.useState([]),[v,b]=a.useState(null),[r,x]=a.useState("all"),[m,h]=a.useState(!1),[k,c]=a.useState(null),[f,p]=a.useState(""),[y,E]=a.useState(!1),[I,z]=a.useState(!1),M=a.useMemo(()=>j.find(d=>d.id===v)||null,[j,v]),U=async()=>{h(!0),c(null);try{const d=await Ie(r==="all"?void 0:r),u=Array.isArray(d==null?void 0:d.data)?d.data:Array.isArray(d)?d:(d==null?void 0:d.data)??[];i(u),!v&&u.length&&b(u[0].id)}catch(d){c((d==null?void 0:d.message)||s("dashboard.messages.errors.load"))}finally{h(!1)}};a.useEffect(()=>{U()},[r]);const N=async(d,u)=>{if(b(d),u==="new"){z(!0);try{await ve(d,"read"),i(o=>o.map(D=>D.id===d?{...D,status:"read"}:D))}catch{}finally{z(!1)}}},L=async()=>{if(!(!M||!f.trim())){E(!0),c(null);try{const d=await Ue(M.id,f.trim());i(u=>u.map(o=>o.id===M.id?{...o,...d}:o)),p("")}catch(d){c((d==null?void 0:d.message)||s("dashboard.messages.errors.reply"))}finally{E(!1)}}},F=async()=>{if(M){z(!0);try{await ve(M.id,M.status==="archived"?"read":"archived"),i(d=>d.map(u=>u.id===M.id?{...u,status:u.status==="archived"?"read":"archived"}:u))}catch(d){c((d==null?void 0:d.message)||s("dashboard.messages.errors.status"))}finally{z(!1)}}};return e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs(te,{className:"lg:col-span-1 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(Te,{className:"text-smart-blue"}),s("dashboard.messages.title")]}),e.jsx("select",{className:"border rounded px-2 py-1 text-sm dark:bg-gray-700 dark:border-gray-600",value:r,onChange:d=>x(d.target.value),children:nt.map(d=>e.jsx("option",{value:d.value,children:s(d.labelKey)},d.value))})]}),m?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(ee,{className:"h-6 w-6"})}):k?e.jsx("div",{className:"text-red-600 text-sm",children:k}):e.jsxs("div",{className:"space-y-2 max-h-[70vh] overflow-auto pr-1",children:[j.length===0&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s("dashboard.messages.empty")}),j.map(d=>e.jsxs("button",{onClick:()=>N(d.id,d.status),className:`w-full text-left p-3 rounded-lg border transition ${v===d.id?"border-smart-blue bg-blue-50 dark:bg-gray-800":"border-gray-200 dark:border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-800 dark:text-gray-100",children:d.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${d.status==="new"?"bg-green-100 text-green-700":d.status==="archived"?"bg-gray-200 text-gray-700":"bg-blue-100 text-blue-700"}`,children:s(`dashboard.messages.status.${d.status}`)})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:d.email}),d.subject&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-300 truncate",children:d.subject}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(d.created_at).toLocaleString()})]},d.id))]})]}),e.jsx(te,{className:"lg:col-span-2 p-6",children:M?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:M.subject||s("dashboard.messages.noSubject")}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[s("dashboard.messages.from"),": ",M.name," (",M.email,")"]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(M.created_at).toLocaleString()})]}),e.jsx($,{onClick:F,variant:"secondary",disabled:I,children:I?s("dashboard.messages.updating"):M.status==="archived"?s("dashboard.messages.unarchive"):s("dashboard.messages.archive")})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-800",children:e.jsx("p",{className:"whitespace-pre-wrap text-gray-800 dark:text-gray-100",children:M.message})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:s("dashboard.messages.replyLabel")}),M.reply_message&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-300",children:[s("dashboard.messages.lastReply")," ",M.replied_at?new Date(M.replied_at).toLocaleString():""]}),e.jsx("textarea",{value:f,onChange:d=>p(d.target.value),rows:4,className:"w-full border rounded-lg p-3 bg-white dark:bg-gray-800 dark:border-gray-700",placeholder:s("dashboard.messages.replyPlaceholder")}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs($,{onClick:L,disabled:y||!f.trim(),className:"flex items-center gap-2",children:[y&&e.jsx(ee,{className:"h-4 w-4"}),s("dashboard.messages.sendReply")]}),M.reply_message&&e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("dashboard.messages.alreadyReplied")})]})]}),k&&e.jsx("div",{className:"text-red-600 text-sm",children:k})]}):e.jsx("p",{className:"text-gray-500 dark:text-gray-300",children:s("dashboard.messages.noSelection")})})]})},it=[{value:"all",labelKey:"dashboard.subscriptions.filter.all"},{value:"active",labelKey:"dashboard.subscriptions.filter.active"},{value:"unsubscribed",labelKey:"dashboard.subscriptions.filter.unsubscribed"}],ot=()=>{const{t:s}=Y(),[j,i]=a.useState([]),[v,b]=a.useState("all"),[r,x]=a.useState(!1),[m,h]=a.useState(null),[k,c]=a.useState(null),[f,p]=a.useState(!1),[y,E]=a.useState(""),[I,z]=a.useState(""),[M,U]=a.useState(!1),[N,L]=a.useState(!1),F=async()=>{x(!0),h(null);try{const l=await Ae(v==="all"?void 0:v),B=Array.isArray(l==null?void 0:l.data)?l.data:Array.isArray(l)?l:(l==null?void 0:l.data)??[];i(B)}catch(l){console.error("Failed to load subscriptions:",l),h((l==null?void 0:l.message)||s("dashboard.subscriptions.errors.load"))}finally{x(!1)}};a.useEffect(()=>{F()},[v]);const d=async l=>{const B=l.status==="active"?"unsubscribed":"active";c(l.id);try{await Pe(l.id,B),i(t=>t.map(g=>g.id===l.id?{...g,status:B}:g))}catch(t){h((t==null?void 0:t.message)||s("dashboard.subscriptions.errors.update"))}finally{c(null)}},u=async l=>{if(confirm(s("dashboard.subscriptions.confirmDelete"))){c(l);try{await Be(l),i(B=>B.filter(t=>t.id!==l))}catch(B){h((B==null?void 0:B.message)||s("dashboard.subscriptions.errors.delete"))}finally{c(null)}}},o=async()=>{if(!(!y.trim()||!I.trim())){U(!0),h(null);try{await He(y,I),L(!0),setTimeout(()=>{p(!1),L(!1),E(""),z("")},2e3)}catch(l){h((l==null?void 0:l.message)||"Failed to send broadcast")}finally{U(!1)}}},D=j.filter(l=>l.status==="active").length;return e.jsxs(e.Fragment,{children:[e.jsxs(te,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(Te,{className:"text-smart-blue"}),s("dashboard.subscriptions.title")||"Email Subscriptions"]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx($,{onClick:()=>p(!0),disabled:D===0,children:s("dashboard.subscriptions.broadcast.button")||"ðŸ“¢ Send Broadcast"}),e.jsx("select",{className:"border rounded px-3 py-2 text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white",value:v,onChange:l=>b(l.target.value),children:it.map(l=>e.jsx("option",{value:l.value,children:s(l.labelKey)||l.value},l.value))}),e.jsx($,{onClick:F,variant:"secondary",disabled:r,children:r?e.jsx(ee,{className:"h-4 w-4"}):s("dashboard.refresh")||"Refresh"})]})]}),m&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400 text-sm",children:m}),r?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ee,{className:"h-8 w-8"})}):j.length===0?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:s("dashboard.subscriptions.empty")||"No subscriptions found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:s("dashboard.subscriptions.email")||"Email"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:s("dashboard.subscriptions.name")||"Name"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:s("dashboard.subscriptions.status")||"Status"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:s("dashboard.subscriptions.date")||"Date"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:s("dashboard.subscriptions.actions")||"Actions"})]})}),e.jsx("tbody",{children:j.map(l=>e.jsxs("tr",{className:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-3 px-4 text-gray-800 dark:text-gray-100",children:l.email}),e.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-300",children:l.name||"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${l.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-400"}`,children:l.status})}),e.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-300 text-sm",children:new Date(l.subscribed_at).toLocaleDateString()}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{variant:"secondary",onClick:()=>d(l),disabled:k===l.id,className:"text-xs py-1 px-2",children:k===l.id?e.jsx(ee,{className:"h-3 w-3"}):l.status==="active"?s("dashboard.subscriptions.unsubscribe")||"Unsubscribe":s("dashboard.subscriptions.resubscribe")||"Resubscribe"}),e.jsx("button",{onClick:()=>u(l.id),disabled:k===l.id,className:"p-1.5 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition",title:s("dashboard.subscriptions.delete")||"Delete",children:e.jsx(ze,{className:"h-4 w-4"})})]})})]},l.id))})]})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400",children:[s("dashboard.subscriptions.total")||"Total",": ",j.length," ",s("dashboard.subscriptions.subscribers")||"subscribers",D>0&&` (${D} active)`]})]}),f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg mx-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:s("dashboard.subscriptions.broadcast.title")||"ðŸ“¢ Send Broadcast"}),e.jsx("button",{onClick:()=>p(!1),className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"âœ•"})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[s("dashboard.subscriptions.broadcast.description")||"This will send an email to all active subscribers."," (",D," ",s("dashboard.subscriptions.broadcast.activeCount")||"active",")"]}),N?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-5xl mb-4",children:"âœ…"}),e.jsx("p",{className:"text-green-600 dark:text-green-400 font-semibold",children:s("dashboard.subscriptions.broadcast.success")||"Broadcast sent successfully!"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[s("dashboard.subscriptions.broadcast.subject")||"Subject"," *"]}),e.jsx("input",{type:"text",value:y,onChange:l=>E(l.target.value),placeholder:s("dashboard.subscriptions.broadcast.subjectPlaceholder")||"Newsletter subject...",className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-smart-blue focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[s("dashboard.subscriptions.broadcast.content")||"Content"," *"]}),e.jsx("textarea",{value:I,onChange:l=>z(l.target.value),placeholder:s("dashboard.subscriptions.broadcast.contentPlaceholder")||"Write your announcement...",rows:6,className:"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-smart-blue focus:outline-none resize-none"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx($,{onClick:o,disabled:M||!y.trim()||!I.trim(),className:"flex-1",children:M?s("dashboard.subscriptions.broadcast.sending")||"Sending...":s("dashboard.subscriptions.broadcast.send")||"Send Broadcast"}),e.jsx($,{variant:"secondary",onClick:()=>p(!1),children:s("dashboard.subscriptions.broadcast.cancel")||"Cancel"})]})]})]})})]})},dt=()=>{Y();const[s,j]=a.useState([]),[i,v]=a.useState(!0),[b,r]=a.useState(!1),[x,m]=a.useState(0),[h,k]=a.useState(null),[c,f]=a.useState(null),[p,y]=a.useState(!1),[E,I]=a.useState(null),z=a.useRef(null),M=a.useCallback(async()=>{try{v(!0),k(null);const o=await Ce("image");j(o.data||[])}catch(o){console.error("Failed to load media:",o),k("Failed to load media library")}finally{v(!1)}},[]);a.useEffect(()=>{M()},[M]);const U=async o=>{if(!o||o.length===0)return;const D=Array.from(o).filter(l=>l.type.startsWith("image/")?l.size>10*1024*1024?(k(`${l.name} exceeds 10MB limit`),!1):!0:(k(`${l.name} is not an image file`),!1));if(D.length!==0){r(!0),m(0),k(null);try{let l=0;for(const B of D){const t=await Me(B);t.media&&j(g=>[t.media,...g]),l++,m(Math.round(l/D.length*100))}f(`Successfully uploaded ${D.length} image(s)`),setTimeout(()=>f(null),3e3)}catch(l){console.error("Upload failed:",l),k(l.message||"Upload failed")}finally{r(!1),m(0)}}},N=o=>{o.preventDefault(),o.stopPropagation(),o.type==="dragenter"||o.type==="dragover"?y(!0):o.type==="dragleave"&&y(!1)},L=o=>{o.preventDefault(),o.stopPropagation(),y(!1),U(o.dataTransfer.files)},F=async o=>{if(window.confirm(`Delete "${o.original_name}"?`))try{await Le(o.id),j(D=>D.filter(l=>l.id!==o.id)),f("Image deleted successfully"),setTimeout(()=>f(null),3e3)}catch(D){console.error("Delete failed:",D),k("Failed to delete image")}},d=o=>{navigator.clipboard.writeText(o),I(o),setTimeout(()=>I(null),2e3)},u=o=>o<1024?o+" B":o<1024*1024?(o/1024).toFixed(1)+" KB":(o/(1024*1024)).toFixed(1)+" MB";return e.jsxs(te,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"ðŸ“ Media Library"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[s.length," ",s.length===1?"image":"images"," uploaded"]})]}),e.jsx("div",{className:`mb-6 p-8 border-2 border-dashed rounded-lg transition-colors cursor-pointer ${p?"border-smart-blue bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"}`,onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:L,onClick:()=>{var o;return(o=z.current)==null?void 0:o.click()},children:e.jsxs("div",{className:"text-center",children:[b?e.jsxs("div",{className:"space-y-3",children:[e.jsx(ae,{className:"w-10 h-10 mx-auto text-smart-blue"}),e.jsx("div",{className:"w-64 h-2 bg-gray-200 rounded-full mx-auto overflow-hidden",children:e.jsx("div",{className:"h-full bg-smart-blue transition-all duration-300",style:{width:`${x}%`}})}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Uploading... ",x,"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-2 text-lg",children:["Drag and drop images here, or ",e.jsx("span",{className:"text-smart-blue font-medium",children:"browse"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Supports: JPG, PNG, GIF, WebP (max 10MB each)"})]}),e.jsx("input",{ref:z,type:"file",accept:"image/*",multiple:!0,onChange:o=>{U(o.target.files),o.target.value=""},className:"hidden"})]})}),h&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:h})}),c&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:c})}),i?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(ae,{className:"w-10 h-10 text-smart-blue"})}):s.length===0?e.jsxs("div",{className:"text-center py-16 text-gray-500 dark:text-gray-400",children:[e.jsx("svg",{className:"w-20 h-20 mx-auto text-gray-300 dark:text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-lg mb-1",children:"No images uploaded yet"}),e.jsx("p",{children:"Upload your first image above to get started"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:s.map(o=>e.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[e.jsx("div",{className:"aspect-square",children:e.jsx("img",{src:o.url,alt:o.alt_text||o.original_name,className:"w-full h-full object-cover",loading:"lazy"})}),e.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100",children:[e.jsx("button",{type:"button",onClick:()=>d(o.url),className:"bg-white text-gray-800 p-2 rounded-full hover:bg-gray-100 transition-all",title:"Copy URL",children:E===o.url?e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})}),e.jsx("button",{type:"button",onClick:()=>F(o),className:"bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition-all",title:"Delete",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsxs("div",{className:"p-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",title:o.original_name,children:o.original_name}),e.jsx("p",{className:"text-xs text-gray-400",children:u(o.size)})]})]},o.id))})]})},ht=()=>{const{user:s}=oe(),{t:j}=Y(),[i,v]=a.useState("posts"),[b,r]=a.useState(!1),x=()=>{switch(i){case"posts":return e.jsx(Se,{});case"media":return e.jsx(dt,{});case"messages":return e.jsx(lt,{});case"subscriptions":return e.jsx(ot,{});case"users":return e.jsx(et,{});case"team":return e.jsx(rt,{});case"settings":return e.jsx(at,{});default:return e.jsx(Se,{})}},m=()=>{const h={posts:j("dashboard.tabs.posts"),media:j("dashboard.tabs.media"),messages:j("dashboard.tabs.messages"),subscriptions:j("dashboard.tabs.subscriptions")||"Subscriptions",users:j("dashboard.tabs.users"),team:j("dashboard.tabs.team"),settings:j("dashboard.tabs.settings")};return h[i]||h.posts};return e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(Xe,{activeSection:i,onSectionChange:v,isOpen:b,onToggle:()=>r(!b)}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"container mx-auto px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:m()}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[j("dashboardPage.welcome")," ",s==null?void 0:s.email]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x()})]})})]})};export{ht as default};

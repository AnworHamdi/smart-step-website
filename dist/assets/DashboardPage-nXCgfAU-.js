import{h as oe,u as Y,j as e,r as a,l as be,m as Ce,n as ae,o as Me,p as Le,D as le,d as ee,q as ie,c as Re,e as Te,t as Ie,v as ve,w as Ue,x as ze,y as Ae,z as He,E as Pe}from"./index-DP7zu8YW.js";import{B as V}from"./Button-C_dQ0a3Q.js";import{C as te}from"./Card-DRQkNWMe.js";const ke=({className:r="w-5 h-5"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),$e=({className:r="w-5 h-5"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Be=({className:r="w-5 h-5"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),Ve=({className:r="w-5 h-5"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),We=({className:r="w-5 h-5"})=>e.jsxs("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Ke=({className:r="w-5 h-5"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),we=({className:r="w-5 h-5"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),_e=({className:r="w-5 h-5"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),Oe=({className:r="w-6 h-6"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),qe=({className:r="w-6 h-6"})=>e.jsx("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Ge=({activeSection:r,onSectionChange:j,isOpen:n,onToggle:v})=>{var b;const{user:g,logout:s}=oe(),{t:x}=Y(),h=[{id:"posts",label:x("dashboard.tabs.posts"),icon:ke},{id:"media",label:x("dashboard.tabs.media"),icon:we},{id:"messages",label:x("dashboard.tabs.messages"),icon:$e},{id:"subscriptions",label:x("dashboard.tabs.subscriptions")||"Subscriptions",icon:Ke},{id:"users",label:x("dashboard.tabs.users"),icon:Be},{id:"team",label:x("dashboard.tabs.team"),icon:Ve},{id:"settings",label:x("dashboard.tabs.settings"),icon:We}],m=[{id:"posts",label:x("dashboard.tabs.posts"),icon:ke},{id:"media",label:x("dashboard.tabs.media"),icon:we}],k=(g==null?void 0:g.role)==="admin"||(g==null?void 0:g.role)==="Super admin"?h:m,c=y=>{j(y),window.innerWidth<1024&&v()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:v,className:"lg:hidden fixed top-20 left-4 z-50 bg-smart-blue text-white p-2 rounded-lg shadow-lg","aria-label":"Toggle menu",children:n?e.jsx(qe,{}):e.jsx(Oe,{})}),n&&e.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30",onClick:v}),e.jsxs("aside",{className:`
          fixed lg:sticky top-0 left-0 h-screen bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700
          w-64 z-40 transform transition-transform duration-300 ease-in-out flex flex-col
          ${n?"translate-x-0":"-translate-x-full lg:translate-x-0"}
        `,children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-smart-blue text-white flex items-center justify-center font-bold text-lg",children:(b=g==null?void 0:g.email)==null?void 0:b.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:g==null?void 0:g.email}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:g==null?void 0:g.role})]})]})}),e.jsx("nav",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("ul",{className:"space-y-2",children:k.map(y=>{const f=y.icon,o=r===y.id;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>c(y.id),className:`
                      w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200
                      ${o?"bg-smart-blue text-white shadow-md":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}
                    `,children:[e.jsx(f,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:y.label})]})},y.id)})})}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("button",{onClick:s,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-all duration-200",children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:x("nav.logout")})]})})]})]})},Ne=({value:r,onChange:j,placeholder:n="Enter content...",className:v="",dir:g="ltr"})=>{const s=a.useRef(null),x=a.useRef(!1);a.useEffect(()=>{s.current&&!x.current&&s.current.innerHTML!==r&&(s.current.innerHTML=r||""),x.current=!1},[r]);const h=a.useCallback(()=>{if(s.current){x.current=!0;const b=s.current.innerHTML,y=b==="<br>"||b==="<div><br></div>"||b.trim()==="";j(y?"":b)}},[j]),m=a.useCallback((b,y)=>{var f;document.execCommand(b,!1,y),(f=s.current)==null||f.focus(),h()},[h]),k=a.useCallback(b=>{b.key==="Tab"&&(b.preventDefault(),m("insertHTML","&nbsp;&nbsp;&nbsp;&nbsp;"))},[m]),c=({onClick:b,title:y,children:f,active:o})=>e.jsx("button",{type:"button",onClick:b,title:y,className:`p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors ${o?"bg-gray-200 dark:bg-gray-600":""}`,children:f});return e.jsxs("div",{className:`rich-text-editor border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden ${v}`,children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 bg-gray-50 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600",children:[e.jsx(c,{onClick:()=>m("bold"),title:"Bold",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"})})}),e.jsx(c,{onClick:()=>m("italic"),title:"Italic",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"})})}),e.jsx(c,{onClick:()=>m("underline"),title:"Underline",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"})})}),e.jsx(c,{onClick:()=>m("strikeThrough"),title:"Strikethrough",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M10 19h4v-3h-4v3zM5 4v3h5v3h4V7h5V4H5zM3 14h18v-2H3v2z"})})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),e.jsxs("select",{onChange:b=>m("formatBlock",b.target.value),className:"px-2 py-1 text-sm bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded",defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Heading"}),e.jsx("option",{value:"p",children:"Normal"}),e.jsx("option",{value:"h1",children:"Heading 1"}),e.jsx("option",{value:"h2",children:"Heading 2"}),e.jsx("option",{value:"h3",children:"Heading 3"})]}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),e.jsx(c,{onClick:()=>m("insertUnorderedList"),title:"Bullet List",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"})})}),e.jsx(c,{onClick:()=>m("insertOrderedList"),title:"Numbered List",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"})})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),e.jsx(c,{onClick:()=>{const b=prompt("Enter URL:");b&&m("createLink",b)},title:"Insert Link",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"})})}),e.jsx(c,{onClick:()=>m("removeFormat"),title:"Clear Formatting",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M3.27 5L2 6.27l6.97 6.97L6.5 19h3l1.57-3.66L16.73 21 18 19.73 3.55 5.27 3.27 5zM6 5v.18L8.82 8h2.4l-.72 1.68 2.1 2.1L14.21 8H20V5H6z"})})})]}),e.jsx("div",{ref:s,contentEditable:!0,dir:g,onInput:h,onKeyDown:k,className:"min-h-[200px] p-4 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none prose prose-sm max-w-none dark:prose-invert",style:{textAlign:g==="rtl"?"right":"left"},"data-placeholder":n,suppressContentEditableWarning:!0}),e.jsx("style",{children:`
        .rich-text-editor [contenteditable]:empty:before {
          content: attr(data-placeholder);
          color: #9ca3af;
          pointer-events: none;
        }
        .rich-text-editor [contenteditable] h1 { font-size: 2em; font-weight: bold; margin: 0.5em 0; }
        .rich-text-editor [contenteditable] h2 { font-size: 1.5em; font-weight: bold; margin: 0.5em 0; }
        .rich-text-editor [contenteditable] h3 { font-size: 1.17em; font-weight: bold; margin: 0.5em 0; }
        .rich-text-editor [contenteditable] p { margin: 0.5em 0; }
        .rich-text-editor [contenteditable] ul, .rich-text-editor [contenteditable] ol { margin: 0.5em 0; padding-left: 1.5em; }
        .rich-text-editor [contenteditable] li { margin: 0.25em 0; }
        .rich-text-editor [contenteditable] a { color: #3b82f6; text-decoration: underline; }
      `})]})},pe=()=>{const[r,j]=a.useState(!1);return{translate:a.useCallback(async(v,g)=>{if(!v.trim())return"";j(!0);try{const s=await be("/translate",{method:"POST",body:JSON.stringify({text:v,context:g})});if(!s.ok)throw new Error("Translation request failed");return(await s.json()).translated_text||""}catch(s){return console.error("Translation Hook Error:",s),""}finally{j(!1)}},[]),isTranslating:r}},Ee=({children:r,color:j="gray",className:n})=>{const v={green:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",gray:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",blue:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300"};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v[j]} ${n}`,children:r})},ue=({isOpen:r,onClose:j,children:n,title:v})=>{const g=a.useRef(null),s=a.useRef(null);return a.useEffect(()=>{var h;if(!r)return;const x=m=>{var k;if(m.key==="Escape")j();else if(m.key==="Tab"){const c=(k=g.current)==null?void 0:k.querySelectorAll("a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled])");if(!c||c.length===0)return;const b=c[0],y=c[c.length-1];m.shiftKey?document.activeElement===b&&(y.focus(),m.preventDefault()):document.activeElement===y&&(b.focus(),m.preventDefault())}};return document.addEventListener("keydown",x),(h=s.current)==null||h.focus(),()=>{document.removeEventListener("keydown",x)}},[r,j]),r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 z-50 flex justify-center items-center p-4",onClick:j,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{ref:g,className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 flex justify-between items-center z-10",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-bold text-gray-800 dark:text-gray-100",children:v}),e.jsx("button",{ref:s,onClick:j,className:"text-gray-400 hover:text-gray-600 dark:hover:text-white transition-colors","aria-label":"Close modal",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-6",children:n})]})}):null},ye=({isOpen:r,onClose:j,onConfirm:n,title:v,message:g})=>{const{t:s}=Y();return e.jsx(ue,{isOpen:r,onClose:j,title:v,children:e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-6",children:g}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(V,{variant:"secondary",onClick:j,children:s("dashboard.confirmDelete.cancel")}),e.jsx("button",{onClick:n,className:"px-8 py-3 rounded-lg font-bold text-sm uppercase tracking-wider transition-all duration-300 transform focus:outline-none focus:ring-4 focus:ring-opacity-50 bg-red-600 text-white shadow-lg hover:shadow-xl focus:ring-red-300 hover:-translate-y-0.5",children:s("dashboard.confirmDelete.confirm")})]})]})})},Xe=({value:r,onChange:j,onClose:n})=>{const[v,g]=a.useState([]),[s,x]=a.useState(!0),[h,m]=a.useState(!1),[k,c]=a.useState(0),[b,y]=a.useState(null),[f,o]=a.useState(r),[D,F]=a.useState(!1),N=a.useRef(null),A=a.useRef(!0);a.useEffect(()=>(A.current=!0,()=>{A.current=!1}),[]);const M=a.useCallback(async()=>{try{x(!0),y(null);const t=await Ce("image");A.current&&g(t.data||[])}catch(t){console.error("Failed to load media:",t),A.current&&y("Failed to load media library")}finally{A.current&&x(!1)}},[]);a.useEffect(()=>{M()},[M]);const T=async t=>{if(!t||t.length===0)return;const p=t[0];if(!p.type.startsWith("image/")){y("Please select an image file");return}if(p.size>10*1024*1024){y("File size must be less than 10MB");return}try{m(!0),c(0),y(null);const L=setInterval(()=>{c(S=>Math.min(S+10,90))},100),w=await Me(p);clearInterval(L),A.current&&w.media&&(c(100),g(S=>[w.media,...S]),o(w.media.url))}catch(L){console.error("Upload failed:",L),A.current&&y(L.message||"Upload failed")}finally{A.current&&(m(!1),c(0))}},R=t=>{t.preventDefault(),t.stopPropagation(),t.type==="dragenter"||t.type==="dragover"?F(!0):t.type==="dragleave"&&F(!1)},d=t=>{t.preventDefault(),t.stopPropagation(),F(!1),T(t.dataTransfer.files)},u=t=>{o(t.url)},i=()=>{f&&j(f),n()},U=()=>{n()},E=async(t,p,L)=>{if(L.stopPropagation(),!!window.confirm("Are you sure you want to delete this image?"))try{await Le(t),A.current&&(g(w=>w.filter(S=>S.id!==t)),f===p&&o(""))}catch(w){console.error("Delete failed:",w),A.current&&y("Failed to delete image")}},O=t=>t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(1)+" MB";return a.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:t=>{t.target===t.currentTarget&&U()},children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Media Library"}),e.jsx("button",{type:"button",onClick:U,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 text-2xl leading-none",children:"Ã—"})]}),e.jsx("div",{className:`m-4 p-6 border-2 border-dashed rounded-lg transition-colors ${D?"border-smart-blue bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"}`,onDragEnter:R,onDragLeave:R,onDragOver:R,onDrop:d,children:e.jsxs("div",{className:"text-center",children:[h?e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"w-8 h-8 mx-auto text-smart-blue"}),e.jsx("div",{className:"w-48 h-2 bg-gray-200 rounded-full mx-auto overflow-hidden",children:e.jsx("div",{className:"h-full bg-smart-blue transition-all duration-300",style:{width:`${k}%`}})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:["Drag and drop an image here, or"," ",e.jsx("button",{type:"button",onClick:()=>{var t;return(t=N.current)==null?void 0:t.click()},className:"text-smart-blue hover:underline font-medium",children:"browse"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Supports: JPG, PNG, GIF, WebP (max 10MB)"})]}),e.jsx("input",{ref:N,type:"file",accept:"image/*",onChange:t=>{T(t.target.files),t.target.value=""},className:"hidden"})]})}),b&&e.jsx("div",{className:"mx-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:b})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 min-h-[200px]",children:s?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ae,{className:"w-8 h-8 text-smart-blue"})}):v.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{children:"No images uploaded yet"}),e.jsx("p",{className:"text-sm",children:"Upload your first image above"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:v.map(t=>e.jsxs("div",{onClick:()=>u(t),className:`relative group cursor-pointer rounded-lg overflow-hidden border-2 transition-all ${f===t.url?"border-smart-blue ring-2 ring-smart-blue ring-opacity-50":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx("div",{className:"aspect-square bg-gray-100 dark:bg-gray-700",children:e.jsx("img",{src:t.url,alt:t.alt_text||t.original_name,className:"w-full h-full object-cover",loading:"lazy"})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all flex items-center justify-center",children:e.jsx("button",{type:"button",onClick:p=>E(t.id,t.url,p),className:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition-all",title:"Delete",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),f===t.url&&e.jsx("div",{className:"absolute top-2 right-2 bg-smart-blue text-white rounded-full p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("p",{className:"text-white text-xs truncate",children:t.original_name}),e.jsx("p",{className:"text-gray-300 text-xs",children:O(t.size)})]})]},t.id))})}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:[e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[v.length," ",v.length===1?"image":"images"," in library"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:U,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:i,disabled:!f,className:"px-4 py-2 text-sm font-medium text-white bg-smart-blue rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Select Image"})]})]})]})})},Se=()=>{const{posts:r,deletePost:j,updatePost:n,addPost:v}=a.useContext(le),{user:g}=oe(),{t:s,language:x}=Y(),{translate:h}=pe(),[m,k]=a.useState("list"),[c,b]=a.useState(null),[y,f]=a.useState(""),[o,D]=a.useState("all"),[F,N]=a.useState(null),A={title:{ar:"",en:""},excerpt:{ar:"",en:""},content:{ar:"",en:""},imageUrl:"",status:"draft"},[M,T]=a.useState(A),[R,d]=a.useState(!1),[u,i]=a.useState({}),[U,E]=a.useState({title:!1,excerpt:!1,content:!1}),[O,t]=a.useState(!1),[p,L]=a.useState(()=>localStorage.getItem("autoTranslateEnabled")!=="false"),w=a.useRef(null),S=a.useRef(null);a.useEffect(()=>{m==="add"&&(T(c?{title:c.title,excerpt:c.excerpt,content:c.content,imageUrl:c.imageUrl,status:c.status}:A),i({}))},[m,c]),a.useEffect(()=>()=>{w.current&&clearTimeout(w.current)},[]);const W=a.useMemo(()=>{let l=r;return g&&g.role==="employee"&&(l=r.filter(C=>C.author===g.email)),l.filter(C=>(x==="ar"?C.title.ar:C.title.en).toLowerCase().includes(y.toLowerCase())).filter(C=>o==="all"?!0:C.status===o)},[r,y,o,x,g]),_=l=>{b(l),k("add")},I=()=>{b(null),k("add")},P=l=>{N(l)},q=async()=>{F&&(await j(F.id),N(null))},G=async l=>{const C=l.status==="published"?"draft":"published";await n({...l,status:C})},X=()=>{const l={title:{},excerpt:{},content:{}};let C=!0;return M.title.en.trim()||(l.title.en=s("contact.validation.fieldRequired"),C=!1),M.title.ar.trim()||(l.title.ar=s("contact.validation.fieldRequired"),C=!1),M.excerpt.en.trim()||(l.excerpt.en=s("contact.validation.fieldRequired"),C=!1),M.excerpt.ar.trim()||(l.excerpt.ar=s("contact.validation.fieldRequired"),C=!1),M.content.en.trim()||(l.content.en=s("contact.validation.fieldRequired"),C=!1),M.content.ar.trim()||(l.content.ar=s("contact.validation.fieldRequired"),C=!1),M.imageUrl.trim()||(l.imageUrl=s("contact.validation.fieldRequired"),C=!1),i(l),C},Q=l=>{const{name:C,value:H}=l.target;if(S.current=C,C.includes(".")){const[B,Z]=C.split(".");T(K=>({...K,[B]:{...K[B],[Z]:H}}))}else T(B=>({...B,[C]:H}));if(!p||(w.current&&clearTimeout(w.current),!C.includes(".")))return;const[z,$]=C.split(".");if(!H.trim()){E(B=>({...B,[z]:!1}));return}E(B=>({...B,[z]:!0})),w.current=window.setTimeout(async()=>{if(S.current!==C){E(J=>({...J,[z]:!1}));return}const B=$==="ar"?"en":"ar",Z=`a blog post ${z}`,K=await h(H,Z);K&&S.current===C&&T(J=>{const xe=H;return J[z][$]===xe?{...J,[z]:{...J[z],[B]:K}}:J}),E(J=>({...J,[z]:!1}))},800)},ne=(l,C,H)=>{const z=`${l}.${C}`;if(S.current=z,T($=>({...$,[l]:{...$[l],[C]:H}})),!!p){if(w.current&&clearTimeout(w.current),!H.trim()||H==="<p><br></p>"){E($=>({...$,[l]:!1}));return}E($=>({...$,[l]:!0})),w.current=window.setTimeout(async()=>{if(S.current!==z){E(K=>({...K,[l]:!1}));return}const $=C==="ar"?"en":"ar",B=`a blog post ${l} in HTML format. Keep the HTML tags (like <p>, <strong>, <ul>, etc.) exactly as they are and only translate the text content inside them.`,Z=await h(H,B);Z&&S.current===z&&T(K=>K[l][C]===H?{...K,[l]:{...K[l],[$]:Z}}:K),E(K=>({...K,[l]:!1}))},1e3)}},de=async l=>{const C=M[l].en.trim(),H=M[l].ar.trim();if(!(!C&&!H)){E(z=>({...z,[l]:!0}));try{const z=`a blog post ${l}`;if(C&&!H){const $=await h(C,z);$&&T(B=>({...B,[l]:{...B[l],ar:$}}))}else if(H&&!C){const $=await h(H,z);$&&T(B=>({...B,[l]:{...B[l],en:$}}))}else if(C){const $=await h(C,z);$&&T(B=>({...B,[l]:{...B[l],ar:$}}))}}catch(z){console.error("Translation failed:",z)}finally{E(z=>({...z,[l]:!1}))}}},fe=async(l,C=!1)=>{if(l.preventDefault(),!X()||!g)return;const H={...M,status:C?"draft":M.status};d(!0);try{c?await n({...c,...H}):await v(H,g.email),T(A),b(null),k("list")}catch(z){console.error("Failed to save post",z),alert("Could not save post. Please try again.")}finally{d(!1)}},je=()=>{T(A),b(null),k("list")},ce=l=>`w-full px-3 py-2 border rounded-lg focus:outline-none transition duration-150 ease-in-out bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400 ${l?"border-red-400 focus:ring-2 focus:ring-red-200":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-smart-blue"}`,he=(l,C,H="input")=>{var K,J,xe,me;const z=H==="input"?"input":"textarea",$=H==="textarea"?l==="excerpt"?3:6:void 0,B=M[l].en.trim()||M[l].ar.trim(),Z=l==="content";return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[C,U[l]&&e.jsx(ae,{className:"inline-block ml-2 h-4 w-4 text-smart-blue"})]}),!p&&B&&e.jsxs("button",{type:"button",onClick:()=>de(l),disabled:U[l],className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-smart-blue hover:text-smart-blue-dark bg-blue-50 dark:bg-blue-900/30 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors disabled:opacity-50",children:[e.jsx(ie,{className:"h-3 w-3"}),U[l]?"Translating...":"Translate"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"English"}),e.jsx(ie,{className:"h-3 w-3 text-gray-400"})]}),Z?e.jsx(Ne,{value:M[l].en,onChange:ge=>ne(l,"en",ge),placeholder:`Enter ${l} in English...`,dir:"ltr"}):e.jsx(z,{name:`${l}.en`,value:M[l].en,onChange:Q,rows:$,className:ce((K=u[l])==null?void 0:K.en),placeholder:`Enter ${l} in English...`}),((J=u[l])==null?void 0:J.en)&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:u[l].en})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"}),e.jsx(ie,{className:"h-3 w-3 text-gray-400"})]}),Z?e.jsx(Ne,{value:M[l].ar,onChange:ge=>ne(l,"ar",ge),placeholder:`Ø£Ø¯Ø®Ù„ ${l==="title"?"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†":l==="excerpt"?"Ø§Ù„Ù…Ù‚ØªØ·Ù":"Ø§Ù„Ù…Ø­ØªÙˆÙ‰"} Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©...`,dir:"rtl"}):e.jsx(z,{name:`${l}.ar`,value:M[l].ar,onChange:Q,dir:"rtl",rows:$,className:ce((xe=u[l])==null?void 0:xe.ar),placeholder:`Ø£Ø¯Ø®Ù„ ${l==="title"?"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†":l==="excerpt"?"Ø§Ù„Ù…Ù‚ØªØ·Ù":"Ø§Ù„Ù…Ø­ØªÙˆÙ‰"} Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©...`}),((me=u[l])==null?void 0:me.ar)&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:u[l].ar})]})]})]})},De=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:s("dashboard.posts.title")}),e.jsx(V,{onClick:I,children:s("dashboard.posts.addPost")})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[e.jsx("input",{type:"text",placeholder:s("dashboard.posts.searchPlaceholder"),value:y,onChange:l=>f(l.target.value),className:"w-full md:w-1/3 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"}),e.jsxs("select",{value:o,onChange:l=>D(l.target.value),className:"w-full md:w-auto px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 bg-white dark:bg-gray-700 dark:text-white dark:border-gray-600",children:[e.jsx("option",{value:"all",children:s("dashboard.posts.all")}),e.jsx("option",{value:"published",children:s("dashboard.posts.published")}),e.jsx("option",{value:"draft",children:s("dashboard.posts.draft")})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:s("dashboard.posts.table.title")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:s("dashboard.posts.table.author")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:s("dashboard.posts.table.status")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:s("dashboard.posts.table.date")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:s("dashboard.posts.table.actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:W.length>0?W.map(l=>e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 dark:odd:bg-gray-800 dark:even:bg-black/10",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:s(l.title)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:l.author}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx(Ee,{color:l.status==="published"?"green":"gray",children:s(`dashboard.posts.${l.status}`)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:l.date}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2 rtl:space-x-reverse",children:[e.jsx("button",{onClick:()=>G(l),className:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300",title:s("dashboard.posts.toggleStatus"),children:l.status==="published"?s("dashboard.posts.unpublish"):s("dashboard.posts.publish")}),e.jsx("button",{onClick:()=>_(l),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:s("dashboard.posts.edit")}),e.jsx("button",{onClick:()=>P(l),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:s("dashboard.posts.delete")})]})]},l.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-10 text-gray-500 dark:text-gray-400",children:s("dashboard.posts.noPosts")})})})]})})]}),Fe=()=>{var l,C,H;return e.jsxs("div",{className:"max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:s(c?"dashboard.postForm.editTitle":"dashboard.postForm.addTitle")}),e.jsx("button",{onClick:je,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:s("dashboard.postsTabs.backToPosts")})]}),e.jsxs("form",{onSubmit:z=>fe(z,!1),className:"space-y-6",children:[he("title",((l=s("dashboard.postForm.titleEn"))==null?void 0:l.replace(" (English)",""))||"Title","input"),he("excerpt",((C=s("dashboard.postForm.excerptEn"))==null?void 0:C.replace(" (English)",""))||"Excerpt","textarea"),he("content",((H=s("dashboard.postForm.contentEn"))==null?void 0:H.replace(" (English)",""))||"Content","textarea"),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("dashboard.postForm.headerImage")}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx("div",{className:"w-32 h-20 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",children:M.imageUrl?e.jsx("img",{src:M.imageUrl,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs text-gray-400",children:"No Image"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",name:"imageUrl",value:M.imageUrl,onChange:Q,placeholder:"https://example.com/image.jpg",className:ce(u.imageUrl)+" flex-1"}),e.jsxs("button",{type:"button",onClick:()=>t(!0),className:"px-4 py-2 text-sm font-medium bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Browse"]})]}),u.imageUrl&&e.jsx("p",{className:"text-red-600 text-xs",children:u.imageUrl}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Enter URL or browse media library"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("dashboard.postForm.status")}),e.jsxs("select",{name:"status",value:M.status,onChange:Q,className:ce()+" max-w-xs",children:[e.jsx("option",{value:"draft",children:s("dashboard.posts.draft")}),e.jsx("option",{value:"published",children:s("dashboard.posts.published")})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(V,{variant:"secondary",onClick:je,type:"button",children:s("dashboard.postForm.cancel")}),e.jsx(V,{variant:"secondary",type:"button",disabled:R,onClick:z=>fe(z,!0),children:"Save as Draft"}),e.jsx(V,{type:"submit",disabled:R,className:"min-w-[120px]",children:R?e.jsx(ee,{className:"h-5 w-5 text-white"}):c?s("dashboard.postForm.save"):"Publish"})]})]})]})};return e.jsxs(te,{children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:e.jsxs("nav",{className:"flex space-x-8 rtl:space-x-reverse","aria-label":"Tabs",children:[e.jsxs("button",{onClick:()=>{k("list"),b(null)},className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${m==="list"?"border-smart-blue text-smart-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400"}`,children:["ðŸ“‹ ",s("dashboard.postsTabs.allPosts")]}),e.jsxs("button",{onClick:()=>{k("add"),b(null)},className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${m==="add"&&!c?"border-smart-blue text-smart-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400"}`,children:["âž• ",s("dashboard.postsTabs.addNew")]}),c&&e.jsxs("span",{className:"py-3 px-1 border-b-2 border-smart-blue text-smart-blue font-medium text-sm",children:["âœï¸ ",s("dashboard.postsTabs.editing")," ",x==="ar"?c.title.ar.substring(0,20):c.title.en.substring(0,20),"..."]})]})}),m==="list"&&De(),m==="add"&&Fe(),F&&e.jsx(ye,{isOpen:!!F,onClose:()=>N(null),onConfirm:q,title:s("dashboard.confirmDelete.title"),message:s("dashboard.confirmDelete.messagePost")}),O&&e.jsx(Xe,{value:M.imageUrl,onChange:l=>T(C=>({...C,imageUrl:l})),onClose:()=>t(!1)})]})},Ye="smartstep.ly",Je=({isOpen:r,onClose:j,user:n})=>{const{addUser:v,updateUser:g,users:s}=a.useContext(le),{t:x,language:h}=Y(),{generateAndShowEmail:m}=oe(),k={email:"",password:"",role:"employee"},[c,b]=a.useState(k),[y,f]=a.useState(!1),[o,D]=a.useState({});a.useEffect(()=>{b(n?{email:n.email,password:"",role:n.role}:k),D({})},[n,r]);const F=()=>{const T={};let R=!0;return c.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.email)?s.some(d=>d.email.toLowerCase()===c.email.toLowerCase()&&d.id!==(n==null?void 0:n.id))?(T.email=x("dashboard.userForm.emailExists"),R=!1):c.email.endsWith(`@${Ye}`)&&(T.email=x("dashboard.userForm.emailDomainRestricted"),R=!1):(T.email=x("contact.validation.invalidEmail"),R=!1):(T.email=x("contact.validation.fieldRequired"),R=!1),!n&&!c.password?(T.password=x("contact.validation.fieldRequired"),R=!1):c.password&&c.password.length<8&&(T.password=x("resetPasswordPage.validation.passwordLength"),R=!1),D(T),R},N=T=>{const{name:R,value:d}=T.target;b(u=>({...u,[R]:d}))},A=async T=>{if(T.preventDefault(),!F())return;f(!0);const R={email:c.email,role:c.role,...c.password&&{password:c.password}};try{if(n)await g({...n,...R,password:c.password||n.password});else{const d=await v(R);if(d){const u=`${window.location.origin}${window.location.pathname}#/verify-email/${d}`;await m("new-user",{verificationLink:u},h)}}j()}catch(d){console.error("Failed to save user",d),alert("Could not save user. Please try again.")}finally{f(!1)}},M=T=>`w-full px-3 py-2 border rounded-lg focus:outline-none transition duration-150 ease-in-out bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400 ${T?"border-red-400 focus:ring-2 focus:ring-red-200":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-smart-blue"}`;return e.jsx(ue,{isOpen:r,onClose:j,title:x(n?"dashboard.userForm.editTitle":"dashboard.userForm.addTitle"),children:e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("dashboard.userForm.email")}),e.jsx("input",{id:"email",type:"email",name:"email",value:c.email,onChange:N,className:M(o.email),"aria-describedby":o.email?"email-error":void 0}),o.email&&e.jsx("p",{id:"email-error",className:"text-red-600 text-xs mt-1",role:"alert",children:o.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("dashboard.userForm.password")}),e.jsx("input",{id:"password",type:"password",name:"password",value:c.password,onChange:N,className:M(o.password),"aria-describedby":o.password?"password-error":void 0}),o.password&&e.jsx("p",{id:"password-error",className:"text-red-600 text-xs mt-1",role:"alert",children:o.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x("dashboard.userForm.role")}),e.jsxs("select",{id:"role",name:"role",value:c.role,onChange:N,className:M(),children:[e.jsx("option",{value:"employee",children:x("dashboard.users.roleEmployee")}),e.jsx("option",{value:"admin",children:x("dashboard.users.roleAdmin")})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-4",children:[e.jsx(V,{variant:"secondary",onClick:j,type:"button",children:x("dashboard.userForm.cancel")}),e.jsx(V,{type:"submit",disabled:y,className:"flex items-center justify-center min-w-[120px]",children:y?e.jsx(ee,{className:"h-5 w-5 text-white"}):x("dashboard.userForm.save")})]})]})})},Qe="arbh.ly@gmail.com",Ze=()=>{const{users:r,deleteUser:j}=a.useContext(le),{t:n}=Y(),[v,g]=a.useState(!1),[s,x]=a.useState(null),[h,m]=a.useState(null),k=f=>{x(f),g(!0)},c=()=>{x(null),g(!0)},b=f=>{m(f)},y=async()=>{h&&(await j(h.id),m(null))};return e.jsxs(te,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:n("dashboard.users.title")}),e.jsx(V,{onClick:c,children:n("dashboard.users.addUser")})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:n("dashboard.users.table.email")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:n("dashboard.users.table.role")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:n("dashboard.users.table.actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:r.length>0?r.map(f=>{const o=f.email===Qe;return e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 dark:odd:bg-gray-800 dark:even:bg-black/10",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:f.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx(Ee,{color:f.role==="Super admin"?"purple":f.role==="admin"?"blue":"gray",children:f.role==="Super admin"?"Super Admin":n(f.role==="admin"?"dashboard.users.roleAdmin":"dashboard.users.roleEmployee")})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2 rtl:space-x-reverse",children:[e.jsx("button",{onClick:()=>k(f),className:`text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 ${o?"opacity-50 cursor-not-allowed":""}`,disabled:o,children:n("dashboard.users.edit")}),e.jsx("button",{onClick:()=>b(f),className:`text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 ${o?"opacity-50 cursor-not-allowed":""}`,disabled:o,children:n("dashboard.users.delete")})]})]},f.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"text-center py-10 text-gray-500 dark:text-gray-400",children:n("dashboard.users.noUsers")})})})]})}),v&&e.jsx(Je,{isOpen:v,onClose:()=>g(!1),user:s}),h&&e.jsx(ye,{isOpen:!!h,onClose:()=>m(null),onConfirm:y,title:n("dashboard.confirmDelete.title"),message:n("dashboard.confirmDelete.messageUser")})]})},se=8,re=128,et=({isOpen:r,onClose:j,onSave:n,imageSrc:v})=>{const g=a.useRef(null),s=a.useRef(null),x=a.useRef(null),[h,m]=a.useState({x:10,y:10,width:100,height:100}),[k,c]=a.useState(!1),[b,y]=a.useState(null),[f,o]=a.useState({x:0,y:0}),D=(t,p)=>{const L=g.current;if(!L)return{x:0,y:0};const w=L.getBoundingClientRect();return{x:t-w.left,y:p-w.top}},F=()=>{const t=g.current,p=t==null?void 0:t.getContext("2d"),L=x.current;if(!t||!p||!L)return;p.clearRect(0,0,t.width,t.height),p.drawImage(L,0,0,t.width,t.height),p.fillStyle="rgba(0, 0, 0, 0.5)",p.fillRect(0,0,t.width,t.height),p.clearRect(h.x,h.y,h.width,h.height),p.strokeStyle="#fff",p.lineWidth=2,p.strokeRect(h.x,h.y,h.width,h.height),p.fillStyle="#fff";const w=A(h);Object.values(w).forEach(S=>{p.fillRect(S.x-se/2,S.y-se/2,se,se)}),N()},N=()=>{const t=s.current,p=t==null?void 0:t.getContext("2d"),L=x.current,w=g.current;if(!t||!p||!L||!w)return;p.clearRect(0,0,t.width,t.height);const S=L.naturalWidth/w.width,W=L.naturalHeight/w.height;p.drawImage(L,h.x*S,h.y*W,h.width*S,h.height*W,0,0,t.width,t.height)};a.useEffect(()=>{const t=new Image;t.src=v,t.onload=()=>{x.current=t;const p=g.current;if(!p)return;const L=t.naturalWidth/t.naturalHeight,w=350;p.width=w,p.height=w/L;const S=Math.min(p.width,p.height)*.8;m({x:(p.width-S)/2,y:(p.height-S)/2,width:S,height:S})}},[v]),a.useEffect(()=>{x.current&&F()},[h,x.current]);const A=t=>({tl:{x:t.x,y:t.y},tr:{x:t.x+t.width,y:t.y},bl:{x:t.x,y:t.y+t.height},br:{x:t.x+t.width,y:t.y+t.height}}),M=(t,p)=>{const L=A(p);for(const w in L){const S=L[w];if(Math.abs(t.x-S.x)<se&&Math.abs(t.y-S.y)<se)return w}return null},T=t=>{const p=M(t,h);p?y(p):t.x>h.x&&t.x<h.x+h.width&&t.y>h.y&&t.y<h.y+h.height&&c(!0),o(t)},R=t=>{const p=g.current;if(!p)return;const L=t.x-f.x,w=t.y-f.y;k?m(S=>({...S,x:Math.max(0,Math.min(S.x+L,p.width-S.width)),y:Math.max(0,Math.min(S.y+w,p.height-S.height))})):b&&m(S=>{let{x:W,y:_,width:I,height:P}=S,q=I,G=P;b.includes("r")&&(q=I+L),b.includes("l")&&(q=I-L,W+=L),b.includes("b")&&(G=P+w),b.includes("t")&&(G=P-w,_+=w);const X=Math.max(q,G);return b.includes("l")&&(W=S.x+S.width-X),b.includes("t")&&(_=S.y+S.height-X),I=X,P=X,W<0&&(W=0,I=S.width+S.x),_<0&&(_=0,P=S.height+S.y),W+I>p.width&&(I=p.width-W,P=I),_+P>p.height&&(P=p.height-_,I=P),{x:W,y:_,width:I,height:P}}),o(t)},d=()=>{c(!1),y(null)},u=t=>T(D(t.clientX,t.clientY)),i=t=>R(D(t.clientX,t.clientY)),U=t=>T(D(t.touches[0].clientX,t.touches[0].clientY)),E=t=>R(D(t.touches[0].clientX,t.touches[0].clientY)),O=()=>{const t=g.current,p=x.current;if(!t||!p)return;const L=document.createElement("canvas");L.width=re,L.height=re;const w=L.getContext("2d");if(!w)return;const S=p.naturalWidth/t.width,W=p.naturalHeight/t.height;w.drawImage(p,h.x*S,h.y*W,h.width*S,h.height*W,0,0,re,re),n(L.toDataURL("image/png"))};return r?e.jsx(ue,{isOpen:r,onClose:j,title:"Crop Logo",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsx("div",{className:"flex-grow",children:e.jsx("canvas",{ref:g,className:"cursor-move border border-gray-300 dark:border-gray-600",onMouseDown:u,onMouseMove:i,onMouseUp:d,onMouseLeave:d,onTouchStart:U,onTouchMove:E,onTouchEnd:d})}),e.jsxs("div",{className:"flex-shrink-0 text-center space-y-2",children:[e.jsx("p",{className:"font-semibold text-sm",children:"Live Preview"}),e.jsx("canvas",{ref:s,width:re,height:re,className:"border-2 border-dashed border-gray-400 dark:border-gray-500 rounded-md"}),e.jsxs("div",{className:"flex gap-2 justify-center pt-4",children:[e.jsx(V,{variant:"secondary",onClick:j,children:"Cancel"}),e.jsx(V,{onClick:O,children:"Save"})]})]})]})}):null},tt=()=>{const{siteInfo:r,updateSiteInfo:j}=a.useContext(le),{user:n}=oe(),{t:v}=Y(),{translate:g}=pe(),[s,x]=a.useState(r),[h,m]=a.useState(!1),[k,c]=a.useState(!1),[b,y]=a.useState(!1),[f,o]=a.useState({isOpen:!1,imageSrc:""}),[D,F]=a.useState(()=>localStorage.getItem("autoTranslateEnabled")!=="false"),[N,A]=a.useState(""),[M,T]=a.useState(!1),[R,d]=a.useState("idle"),u=a.useRef(null),i=a.useRef(null),U=a.useRef(null),E=(n==null?void 0:n.role)==="Super admin";a.useEffect(()=>{x(r)},[r]),a.useEffect(()=>()=>{i.current&&clearTimeout(i.current)},[]);const O=()=>{const I=!D;F(I),localStorage.setItem("autoTranslateEnabled",String(I))},t=async()=>{if(N.trim()){d("saving");try{await be("/settings",{method:"PUT",body:JSON.stringify({settings:[{key:"gemini_api_key",value:N,group:"translation"}]})}),d("saved"),setTimeout(()=>d("idle"),3e3)}catch(I){console.error("Failed to save API key:",I),d("error")}}},p=async()=>{d("saving");try{await be("/settings",{method:"PUT",body:JSON.stringify({settings:[{key:"gemini_api_key",value:"",group:"translation"}]})}),A(""),d("idle")}catch(I){console.error("Failed to delete API key:",I),d("error")}},L=I=>{const{name:P,value:q}=I.target;if(U.current=P,P.includes(".")){const[G,X]=P.split(".");x(Q=>({...Q,[G]:{...Q[G],[X]:q}}))}else x(G=>({...G,[P]:q}));if(D&&(i.current&&clearTimeout(i.current),!!P.includes("."))){if(!q.trim()){y(!1);return}y(!0),i.current=window.setTimeout(async()=>{if(U.current!==P){y(!1);return}const[G,X]=P.split("."),Q=X==="ar"?"en":"ar",ne=await g(q,"a business address");ne&&U.current===P&&x(de=>({...de,address:{...de.address,[Q]:ne}})),y(!1)},800)}},w=I=>{I.preventDefault(),m(!0),setTimeout(()=>{j(s),m(!1),c(!0),setTimeout(()=>c(!1),3e3)},1e3)},S=I=>{if(I.target.files&&I.target.files[0]){const P=I.target.files[0],q=new FileReader;q.onload=G=>{var X;o({isOpen:!0,imageSrc:(X=G.target)==null?void 0:X.result})},q.readAsDataURL(P),I.target.value=""}},W=I=>{x(P=>({...P,logoUrl:I})),o({isOpen:!1,imageSrc:""})},_=()=>"w-full px-3 py-2 border rounded-lg focus:outline-none transition duration-150 ease-in-out bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400 border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-smart-blue";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(te,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:v("dashboard.settings.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:v("dashboard.settings.subtitle")})]}),e.jsxs("form",{onSubmit:w,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Website Logo"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 dark:bg-gray-700 border dark:border-gray-600 rounded-md flex items-center justify-center overflow-hidden",children:s.logoUrl?e.jsx("img",{src:s.logoUrl,alt:"Logo Preview",className:"max-w-full max-h-full object-contain"}):e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 p-2 text-center",children:"No Logo"})}),e.jsx("input",{type:"file",accept:"image/png, image/jpeg, image/svg+xml",ref:u,onChange:S,hidden:!0}),e.jsx(V,{type:"button",variant:"secondary",onClick:()=>{var I;return(I=u.current)==null?void 0:I.click()},children:"Upload Logo"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 relative",children:[e.jsx("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 rtl:translate-x-1/2 flex items-center justify-center h-5 w-5 bg-gray-100 dark:bg-gray-600 rounded-full border dark:border-gray-500 z-10",children:b?e.jsx(ae,{className:"h-4 w-4 text-smart-blue"}):e.jsx(ie,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v("dashboard.settings.addressEn")}),e.jsx("input",{type:"text",name:"address.en",value:s.address.en,onChange:L,className:_()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v("dashboard.settings.addressAr")}),e.jsx("input",{type:"text",name:"address.ar",value:s.address.ar,onChange:L,dir:"rtl",className:_()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v("dashboard.settings.phone")}),e.jsx("input",{type:"text",name:"phone",value:s.phone,onChange:L,className:_()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v("dashboard.settings.email")}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:L,className:_()})]}),e.jsxs("div",{className:"pt-4 flex items-center gap-4",children:[e.jsx(V,{type:"submit",disabled:h,className:"flex items-center justify-center min-w-[120px]",children:h?e.jsx(ee,{className:"h-5 w-5 text-white"}):v("dashboard.settings.save")}),k&&e.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400 transition-opacity duration-300",children:[e.jsx(Re,{className:"h-5 w-5"}),e.jsx("span",{children:v("dashboard.settings.success")})]})]})]})]}),e.jsxs(te,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Translation Settings"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Configure automatic translation behavior"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Auto-Translate Content"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Automatically translate content as you type"})]}),e.jsx("button",{type:"button",onClick:O,className:`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-smart-blue focus:ring-offset-2 ${D?"bg-smart-blue":"bg-gray-300 dark:bg-gray-600"}`,children:e.jsx("span",{className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${D?"translate-x-5":"translate-x-0"}`})})]}),E&&e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Gemini API Key (Super Admin Only)"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:M?"text":"password",value:N,onChange:I=>A(I.target.value),placeholder:"Enter your Gemini API key",className:_()}),e.jsx("button",{type:"button",onClick:()=>T(!M),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:M?"ðŸ™ˆ":"ðŸ‘"})]})}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(V,{type:"button",onClick:t,disabled:!N.trim()||R==="saving",className:"text-sm",children:R==="saving"?"Saving...":R==="saved"?"âœ“ Saved":"Save Key"}),e.jsx(V,{type:"button",variant:"secondary",onClick:p,className:"text-sm",children:"Delete Key"})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Get your API key from ",e.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-smart-blue hover:underline",children:"Google AI Studio"})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Note:"})," When auto-translate is enabled, content will be automatically translated as you type in either language field. The translation uses Google's Gemini AI."]})})]})]})]}),f.isOpen&&e.jsx(et,{isOpen:f.isOpen,onClose:()=>o({isOpen:!1,imageSrc:""}),imageSrc:f.imageSrc,onSave:W})]})},at=({isOpen:r,onClose:j,member:n})=>{const{addTeamMember:v,updateTeamMember:g}=a.useContext(le),{t:s}=Y(),{translate:x}=pe(),h={name:{ar:"",en:""},role:{ar:"",en:""},imageUrl:""},[m,k]=a.useState(h),[c,b]=a.useState(!1),[y,f]=a.useState({}),[o,D]=a.useState({name:!1,role:!1}),F=a.useRef(null),N=a.useRef(null);a.useEffect(()=>{k(n?{name:n.name,role:n.role,imageUrl:n.imageUrl}:h),f({}),D({name:!1,role:!1})},[n,r]),a.useEffect(()=>()=>{F.current&&clearTimeout(F.current)},[]);const A=()=>{const u={name:{},role:{}};let i=!0;return m.name.en.trim()||(u.name.en=s("contact.validation.fieldRequired"),i=!1),m.name.ar.trim()||(u.name.ar=s("contact.validation.fieldRequired"),i=!1),m.role.en.trim()||(u.role.en=s("contact.validation.fieldRequired"),i=!1),m.role.ar.trim()||(u.role.ar=s("contact.validation.fieldRequired"),i=!1),m.imageUrl.trim()||(u.imageUrl=s("contact.validation.fieldRequired"),i=!1),f(u),i},M=u=>{const{name:i,value:U}=u.target;if(N.current=i,i.includes(".")){const[t,p]=i.split(".");k(L=>({...L,[t]:{...L[t],[p]:U}}))}else k(t=>({...t,[i]:U}));if(F.current&&clearTimeout(F.current),!i.includes("."))return;const[E,O]=i.split(".");if(!U.trim()){D(t=>({...t,[E]:!1}));return}D(t=>({...t,[E]:!0})),F.current=window.setTimeout(async()=>{if(N.current!==i){D(w=>({...w,[E]:!1}));return}const t=O==="ar"?"en":"ar",p=`a team member's ${E}`,L=await x(U,p);L&&N.current===i&&k(w=>({...w,[E]:{...w[E],[t]:L}})),D(w=>({...w,[E]:!1}))},800)},T=u=>{u.preventDefault(),A()&&(b(!0),setTimeout(()=>{n?g({...n,...m}):v(m),b(!1),j()},1e3))},R=u=>`w-full px-3 py-2 border rounded-lg focus:outline-none transition duration-150 ease-in-out bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400 ${u?"border-red-400 focus:ring-2 focus:ring-red-200":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-smart-blue"}`,d=u=>{var i,U,E,O,t,p;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 relative",children:[e.jsx("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 rtl:translate-x-1/2 flex items-center justify-center h-5 w-5 bg-gray-100 dark:bg-gray-600 rounded-full border dark:border-gray-500 z-10",children:o[u]?e.jsx(ae,{}):e.jsx(ie,{})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`${u}-en`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s(`dashboard.teamForm.${u}En`)}),e.jsx("input",{type:"text",id:`${u}-en`,name:`${u}.en`,value:m[u].en,onChange:M,className:R((i=y[u])==null?void 0:i.en),"aria-describedby":(U=y[u])!=null&&U.en?`${u}-en-error`:void 0}),((E=y[u])==null?void 0:E.en)&&e.jsx("p",{id:`${u}-en-error`,className:"text-red-600 text-xs mt-1",role:"alert",children:y[u].en})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`${u}-ar`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s(`dashboard.teamForm.${u}Ar`)}),e.jsx("input",{type:"text",id:`${u}-ar`,name:`${u}.ar`,value:m[u].ar,onChange:M,dir:"rtl",className:R((O=y[u])==null?void 0:O.ar),"aria-describedby":(t=y[u])!=null&&t.ar?`${u}-ar-error`:void 0}),((p=y[u])==null?void 0:p.ar)&&e.jsx("p",{id:`${u}-ar-error`,className:"text-red-600 text-xs mt-1",role:"alert",children:y[u].ar})]})]})};return e.jsx(ue,{isOpen:r,onClose:j,title:s(n?"dashboard.teamForm.editTitle":"dashboard.teamForm.addTitle"),children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[d("name"),d("role"),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("dashboard.teamForm.imageUrl")}),e.jsx("input",{id:"imageUrl",type:"text",name:"imageUrl",value:m.imageUrl,onChange:M,className:R(y.imageUrl),"aria-describedby":y.imageUrl?"imageUrl-error":void 0}),y.imageUrl&&e.jsx("p",{id:"imageUrl-error",className:"text-red-600 text-xs mt-1",role:"alert",children:y.imageUrl})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-4",children:[e.jsx(V,{variant:"secondary",onClick:j,type:"button",children:s("dashboard.teamForm.cancel")}),e.jsx(V,{type:"submit",disabled:c,className:"flex items-center justify-center min-w-[120px]",children:c?e.jsx(ee,{}):s(n?"dashboard.teamForm.save":"dashboard.teamForm.addTitle")})]})]})})},st=()=>{const{teamMembers:r,deleteTeamMember:j}=a.useContext(le),{t:n}=Y(),[v,g]=a.useState(!1),[s,x]=a.useState(null),[h,m]=a.useState(null),k=f=>{x(f),g(!0)},c=()=>{x(null),g(!0)},b=f=>{m(f)},y=()=>{h&&(j(h.id),m(null))};return e.jsxs(te,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:n("dashboard.team.title")}),e.jsx(V,{onClick:c,children:n("dashboard.team.addMember")})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:n("dashboard.team.table.photo")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:n("dashboard.team.table.name")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:n("dashboard.team.table.role")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:n("dashboard.team.table.actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:r.length>0?r.map(f=>e.jsxs("tr",{className:"odd:bg-white even:bg-gray-50 dark:odd:bg-gray-800 dark:even:bg-black/10",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:f.imageUrl,alt:n(f.name)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:n(f.name)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:n(f.role)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2 rtl:space-x-reverse",children:[e.jsx("button",{onClick:()=>k(f),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:n("dashboard.team.edit")}),e.jsx("button",{onClick:()=>b(f),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:n("dashboard.team.delete")})]})]},f.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-10 text-gray-500 dark:text-gray-400",children:n("dashboard.team.noMembers")})})})]})}),v&&e.jsx(at,{isOpen:v,onClose:()=>g(!1),member:s}),h&&e.jsx(ye,{isOpen:!!h,onClose:()=>m(null),onConfirm:y,title:n("dashboard.confirmDelete.title"),message:n("dashboard.confirmDelete.messageTeamMember")})]})},rt=[{value:"all",labelKey:"dashboard.messages.filter.all"},{value:"new",labelKey:"dashboard.messages.filter.new"},{value:"read",labelKey:"dashboard.messages.filter.read"},{value:"archived",labelKey:"dashboard.messages.filter.archived"}],lt=()=>{const{t:r}=Y(),[j,n]=a.useState([]),[v,g]=a.useState(null),[s,x]=a.useState("all"),[h,m]=a.useState(!1),[k,c]=a.useState(null),[b,y]=a.useState(""),[f,o]=a.useState(!1),[D,F]=a.useState(!1),N=a.useMemo(()=>j.find(d=>d.id===v)||null,[j,v]),A=async()=>{m(!0),c(null);try{const d=await Ie(s==="all"?void 0:s),u=Array.isArray(d==null?void 0:d.data)?d.data:Array.isArray(d)?d:(d==null?void 0:d.data)??[];n(u),!v&&u.length&&g(u[0].id)}catch(d){c((d==null?void 0:d.message)||r("dashboard.messages.errors.load"))}finally{m(!1)}};a.useEffect(()=>{A()},[s]);const M=async(d,u)=>{if(g(d),u==="new"){F(!0);try{await ve(d,"read"),n(i=>i.map(U=>U.id===d?{...U,status:"read"}:U))}catch{}finally{F(!1)}}},T=async()=>{if(!(!N||!b.trim())){o(!0),c(null);try{const d=await Ue(N.id,b.trim());n(u=>u.map(i=>i.id===N.id?{...i,...d}:i)),y("")}catch(d){c((d==null?void 0:d.message)||r("dashboard.messages.errors.reply"))}finally{o(!1)}}},R=async()=>{if(N){F(!0);try{await ve(N.id,N.status==="archived"?"read":"archived"),n(d=>d.map(u=>u.id===N.id?{...u,status:u.status==="archived"?"read":"archived"}:u))}catch(d){c((d==null?void 0:d.message)||r("dashboard.messages.errors.status"))}finally{F(!1)}}};return e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs(te,{className:"lg:col-span-1 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(Te,{className:"text-smart-blue"}),r("dashboard.messages.title")]}),e.jsx("select",{className:"border rounded px-2 py-1 text-sm dark:bg-gray-700 dark:border-gray-600",value:s,onChange:d=>x(d.target.value),children:rt.map(d=>e.jsx("option",{value:d.value,children:r(d.labelKey)},d.value))})]}),h?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(ee,{className:"h-6 w-6"})}):k?e.jsx("div",{className:"text-red-600 text-sm",children:k}):e.jsxs("div",{className:"space-y-2 max-h-[70vh] overflow-auto pr-1",children:[j.length===0&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r("dashboard.messages.empty")}),j.map(d=>e.jsxs("button",{onClick:()=>M(d.id,d.status),className:`w-full text-left p-3 rounded-lg border transition ${v===d.id?"border-smart-blue bg-blue-50 dark:bg-gray-800":"border-gray-200 dark:border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-semibold text-sm text-gray-800 dark:text-gray-100",children:d.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${d.status==="new"?"bg-green-100 text-green-700":d.status==="archived"?"bg-gray-200 text-gray-700":"bg-blue-100 text-blue-700"}`,children:r(`dashboard.messages.status.${d.status}`)})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:d.email}),d.subject&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-300 truncate",children:d.subject}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(d.created_at).toLocaleString()})]},d.id))]})]}),e.jsx(te,{className:"lg:col-span-2 p-6",children:N?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:N.subject||r("dashboard.messages.noSubject")}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[r("dashboard.messages.from"),": ",N.name," (",N.email,")"]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(N.created_at).toLocaleString()})]}),e.jsx(V,{onClick:R,variant:"secondary",disabled:D,children:D?r("dashboard.messages.updating"):N.status==="archived"?r("dashboard.messages.unarchive"):r("dashboard.messages.archive")})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-800",children:e.jsx("p",{className:"whitespace-pre-wrap text-gray-800 dark:text-gray-100",children:N.message})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:r("dashboard.messages.replyLabel")}),N.reply_message&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-300",children:[r("dashboard.messages.lastReply")," ",N.replied_at?new Date(N.replied_at).toLocaleString():""]}),e.jsx("textarea",{value:b,onChange:d=>y(d.target.value),rows:4,className:"w-full border rounded-lg p-3 bg-white dark:bg-gray-800 dark:border-gray-700",placeholder:r("dashboard.messages.replyPlaceholder")}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(V,{onClick:T,disabled:f||!b.trim(),className:"flex items-center gap-2",children:[f&&e.jsx(ee,{className:"h-4 w-4"}),r("dashboard.messages.sendReply")]}),N.reply_message&&e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:r("dashboard.messages.alreadyReplied")})]})]}),k&&e.jsx("div",{className:"text-red-600 text-sm",children:k})]}):e.jsx("p",{className:"text-gray-500 dark:text-gray-300",children:r("dashboard.messages.noSelection")})})]})},nt=[{value:"all",labelKey:"dashboard.subscriptions.filter.all"},{value:"active",labelKey:"dashboard.subscriptions.filter.active"},{value:"unsubscribed",labelKey:"dashboard.subscriptions.filter.unsubscribed"}],it=()=>{const{t:r}=Y(),[j,n]=a.useState([]),[v,g]=a.useState("all"),[s,x]=a.useState(!1),[h,m]=a.useState(null),[k,c]=a.useState(null),b=async()=>{x(!0),m(null);try{const o=await Ae(v==="all"?void 0:v),D=Array.isArray(o==null?void 0:o.data)?o.data:Array.isArray(o)?o:(o==null?void 0:o.data)??[];n(D)}catch(o){console.error("Failed to load subscriptions:",o),m((o==null?void 0:o.message)||r("dashboard.subscriptions.errors.load"))}finally{x(!1)}};a.useEffect(()=>{b()},[v]);const y=async o=>{const D=o.status==="active"?"unsubscribed":"active";c(o.id);try{await He(o.id,D),n(F=>F.map(N=>N.id===o.id?{...N,status:D}:N))}catch(F){m((F==null?void 0:F.message)||r("dashboard.subscriptions.errors.update"))}finally{c(null)}},f=async o=>{if(confirm(r("dashboard.subscriptions.confirmDelete"))){c(o);try{await Pe(o),n(D=>D.filter(F=>F.id!==o))}catch(D){m((D==null?void 0:D.message)||r("dashboard.subscriptions.errors.delete"))}finally{c(null)}}};return e.jsxs(te,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(Te,{className:"text-smart-blue"}),r("dashboard.subscriptions.title")||"Email Subscriptions"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("select",{className:"border rounded px-3 py-2 text-sm dark:bg-gray-700 dark:border-gray-600",value:v,onChange:o=>g(o.target.value),children:nt.map(o=>e.jsx("option",{value:o.value,children:r(o.labelKey)||o.value},o.value))}),e.jsx(V,{onClick:b,variant:"secondary",disabled:s,children:s?e.jsx(ee,{className:"h-4 w-4"}):r("dashboard.refresh")||"Refresh"})]})]}),h&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400 text-sm",children:h}),s?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ee,{className:"h-8 w-8"})}):j.length===0?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:r("dashboard.subscriptions.empty")||"No subscriptions found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:r("dashboard.subscriptions.email")||"Email"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:r("dashboard.subscriptions.name")||"Name"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:r("dashboard.subscriptions.source")||"Source"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:r("dashboard.subscriptions.status")||"Status"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:r("dashboard.subscriptions.date")||"Date"}),e.jsx("th",{className:"py-3 px-4 font-semibold text-gray-700 dark:text-gray-200",children:r("dashboard.subscriptions.actions")||"Actions"})]})}),e.jsx("tbody",{children:j.map(o=>e.jsxs("tr",{className:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-3 px-4 text-gray-800 dark:text-gray-100",children:o.email}),e.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-300",children:o.name||"-"}),e.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-300",children:e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:o.source||"website"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${o.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-400"}`,children:o.status})}),e.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-300 text-sm",children:new Date(o.subscribed_at).toLocaleDateString()}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"secondary",onClick:()=>y(o),disabled:k===o.id,className:"text-xs py-1 px-2",children:k===o.id?e.jsx(ee,{className:"h-3 w-3"}):o.status==="active"?r("dashboard.subscriptions.unsubscribe")||"Unsubscribe":r("dashboard.subscriptions.resubscribe")||"Resubscribe"}),e.jsx("button",{onClick:()=>f(o.id),disabled:k===o.id,className:"p-1.5 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition",title:r("dashboard.subscriptions.delete")||"Delete",children:e.jsx(ze,{className:"h-4 w-4"})})]})})]},o.id))})]})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400",children:[r("dashboard.subscriptions.total")||"Total",": ",j.length," ",r("dashboard.subscriptions.subscribers")||"subscribers"]})]})},ot=()=>{Y();const[r,j]=a.useState([]),[n,v]=a.useState(!0),[g,s]=a.useState(!1),[x,h]=a.useState(0),[m,k]=a.useState(null),[c,b]=a.useState(null),[y,f]=a.useState(!1),[o,D]=a.useState(null),F=a.useRef(null),N=a.useCallback(async()=>{try{v(!0),k(null);const i=await Ce("image");j(i.data||[])}catch(i){console.error("Failed to load media:",i),k("Failed to load media library")}finally{v(!1)}},[]);a.useEffect(()=>{N()},[N]);const A=async i=>{if(!i||i.length===0)return;const U=Array.from(i).filter(E=>E.type.startsWith("image/")?E.size>10*1024*1024?(k(`${E.name} exceeds 10MB limit`),!1):!0:(k(`${E.name} is not an image file`),!1));if(U.length!==0){s(!0),h(0),k(null);try{let E=0;for(const O of U){const t=await Me(O);t.media&&j(p=>[t.media,...p]),E++,h(Math.round(E/U.length*100))}b(`Successfully uploaded ${U.length} image(s)`),setTimeout(()=>b(null),3e3)}catch(E){console.error("Upload failed:",E),k(E.message||"Upload failed")}finally{s(!1),h(0)}}},M=i=>{i.preventDefault(),i.stopPropagation(),i.type==="dragenter"||i.type==="dragover"?f(!0):i.type==="dragleave"&&f(!1)},T=i=>{i.preventDefault(),i.stopPropagation(),f(!1),A(i.dataTransfer.files)},R=async i=>{if(window.confirm(`Delete "${i.original_name}"?`))try{await Le(i.id),j(U=>U.filter(E=>E.id!==i.id)),b("Image deleted successfully"),setTimeout(()=>b(null),3e3)}catch(U){console.error("Delete failed:",U),k("Failed to delete image")}},d=i=>{navigator.clipboard.writeText(i),D(i),setTimeout(()=>D(null),2e3)},u=i=>i<1024?i+" B":i<1024*1024?(i/1024).toFixed(1)+" KB":(i/(1024*1024)).toFixed(1)+" MB";return e.jsxs(te,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"ðŸ“ Media Library"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.length," ",r.length===1?"image":"images"," uploaded"]})]}),e.jsx("div",{className:`mb-6 p-8 border-2 border-dashed rounded-lg transition-colors cursor-pointer ${y?"border-smart-blue bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400"}`,onDragEnter:M,onDragLeave:M,onDragOver:M,onDrop:T,onClick:()=>{var i;return(i=F.current)==null?void 0:i.click()},children:e.jsxs("div",{className:"text-center",children:[g?e.jsxs("div",{className:"space-y-3",children:[e.jsx(ae,{className:"w-10 h-10 mx-auto text-smart-blue"}),e.jsx("div",{className:"w-64 h-2 bg-gray-200 rounded-full mx-auto overflow-hidden",children:e.jsx("div",{className:"h-full bg-smart-blue transition-all duration-300",style:{width:`${x}%`}})}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Uploading... ",x,"%"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-2 text-lg",children:["Drag and drop images here, or ",e.jsx("span",{className:"text-smart-blue font-medium",children:"browse"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Supports: JPG, PNG, GIF, WebP (max 10MB each)"})]}),e.jsx("input",{ref:F,type:"file",accept:"image/*",multiple:!0,onChange:i=>{A(i.target.files),i.target.value=""},className:"hidden"})]})}),m&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:m})}),c&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:c})}),n?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(ae,{className:"w-10 h-10 text-smart-blue"})}):r.length===0?e.jsxs("div",{className:"text-center py-16 text-gray-500 dark:text-gray-400",children:[e.jsx("svg",{className:"w-20 h-20 mx-auto text-gray-300 dark:text-gray-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-lg mb-1",children:"No images uploaded yet"}),e.jsx("p",{children:"Upload your first image above to get started"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:r.map(i=>e.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:[e.jsx("div",{className:"aspect-square",children:e.jsx("img",{src:i.url,alt:i.alt_text||i.original_name,className:"w-full h-full object-cover",loading:"lazy"})}),e.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100",children:[e.jsx("button",{type:"button",onClick:()=>d(i.url),className:"bg-white text-gray-800 p-2 rounded-full hover:bg-gray-100 transition-all",title:"Copy URL",children:o===i.url?e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})}),e.jsx("button",{type:"button",onClick:()=>R(i),className:"bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition-all",title:"Delete",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsxs("div",{className:"p-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",title:i.original_name,children:i.original_name}),e.jsx("p",{className:"text-xs text-gray-400",children:u(i.size)})]})]},i.id))})]})},ut=()=>{const{user:r}=oe(),{t:j}=Y(),[n,v]=a.useState("posts"),[g,s]=a.useState(!1),x=()=>{switch(n){case"posts":return e.jsx(Se,{});case"media":return e.jsx(ot,{});case"messages":return e.jsx(lt,{});case"subscriptions":return e.jsx(it,{});case"users":return e.jsx(Ze,{});case"team":return e.jsx(st,{});case"settings":return e.jsx(tt,{});default:return e.jsx(Se,{})}},h=()=>{const m={posts:j("dashboard.tabs.posts"),media:j("dashboard.tabs.media"),messages:j("dashboard.tabs.messages"),subscriptions:j("dashboard.tabs.subscriptions")||"Subscriptions",users:j("dashboard.tabs.users"),team:j("dashboard.tabs.team"),settings:j("dashboard.tabs.settings")};return m[n]||m.posts};return e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(Ge,{activeSection:n,onSectionChange:v,isOpen:g,onToggle:()=>s(!g)}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"container mx-auto px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:h()}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[j("dashboardPage.welcome")," ",r==null?void 0:r.email]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:x()})]})})]})};export{ut as default};
